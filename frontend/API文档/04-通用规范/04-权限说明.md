---
tags:
  - APIæ–‡æ¡£
  - è§„èŒƒ
  - æƒé™
created: 2025-11-21
modified: 2025-11-21
category: é€šç”¨è§„èŒƒ
difficulty: beginner
---

# ğŸ” æƒé™è¯´æ˜

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£å®šä¹‰äº†ç³»ç»Ÿçš„ç”¨æˆ·è§’è‰²å’Œå„APIæ¥å£çš„æƒé™è¦æ±‚ã€‚

## ğŸ‘¥ ç”¨æˆ·è§’è‰²

### USER (æ™®é€šç”¨æˆ·)
- **è§’è‰²æ ‡è¯†**: `USER`
- **æƒé™æè¿°**: æ™®é€šç”¨æˆ·ï¼Œå¯ä»¥æµè§ˆå•†å“ã€ä¸‹å•è´­ä¹°
- **å…¸å‹æ“ä½œ**:
  - æµè§ˆå•†å“åˆ—è¡¨
  - æŸ¥çœ‹å•†å“è¯¦æƒ…
  - æœç´¢å•†å“
  - æŸ¥çœ‹å•†å“ç»Ÿè®¡ä¿¡æ¯

### SHOPER (å•†å®¶)
- **è§’è‰²æ ‡è¯†**: `SHOPER`
- **æƒé™æè¿°**: å•†å®¶ç”¨æˆ·ï¼Œå¯ä»¥ç®¡ç†è‡ªå·±åˆ›å»ºçš„å•†å“
- **å…¸å‹æ“ä½œ**:
  - åˆ›å»ºå•†å“
  - æ›´æ–°è‡ªå·±åˆ›å»ºçš„å•†å“
  - åˆ é™¤è‡ªå·±åˆ›å»ºçš„å•†å“
  - ä¸Šæ¶/ä¸‹æ¶è‡ªå·±åˆ›å»ºçš„å•†å“
  - æ›´æ–°å•†å“åº“å­˜ã€ä»·æ ¼ã€æŠ˜æ‰£
  - ä¸Šä¼ å•†å“å›¾ç‰‡
  - æŸ¥çœ‹è‡ªå·±çš„å•†å“ç»Ÿè®¡ä¿¡æ¯
  - æ‰¹é‡æ“ä½œè‡ªå·±åˆ›å»ºçš„å•†å“

### ADMIN (ç®¡ç†å‘˜)
- **è§’è‰²æ ‡è¯†**: `ADMIN`
- **æƒé™æè¿°**: ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæ‹¥æœ‰æ‰€æœ‰æƒé™
- **å…¸å‹æ“ä½œ**:
  - æ‰€æœ‰USERå’ŒSHOPERçš„æ“ä½œ
  - åˆ é™¤ä»»ä½•å•†å“
  - æŸ¥çœ‹æ‰€æœ‰å•†å“ç»Ÿè®¡ä¿¡æ¯
  - æ‰¹é‡åˆ é™¤ä»»ä½•å•†å“

## ğŸ”’ æ¥å£æƒé™è¦æ±‚

### è®¤è¯ç›¸å…³æ¥å£
| æ¥å£ | æƒé™è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| `POST /auth/login` | æ— éœ€è®¤è¯ | ç”¨æˆ·ç™»å½• |
| `POST /auth/register` | æ— éœ€è®¤è¯ | ç”¨æˆ·æ³¨å†Œ |
| `GET /auth/userinfo` | å·²è®¤è¯ç”¨æˆ· | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| `POST /auth/logout` | å·²è®¤è¯ç”¨æˆ· | ç”¨æˆ·ç™»å‡º |

### å…¬å…±æ¥å£
| æ¥å£ | æƒé™è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| `GET /api/public/health` | æ— éœ€è®¤è¯ | å¥åº·æ£€æŸ¥ |

### å•†å“æŸ¥è¯¢æ¥å£
| æ¥å£ | æƒé™è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| `GET /products` | æ— éœ€è®¤è¯ | å•†å“åˆ—è¡¨ |
| `GET /products/merchant` | SHOPERè§’è‰² | å•†å®¶å•†å“åˆ—è¡¨ |
| `GET /products/{id}` | æ— éœ€è®¤è¯ | å•†å“è¯¦æƒ… |
| `GET /products/search` | æ— éœ€è®¤è¯ | å•†å“æœç´¢ |
| `GET /products/category/{category}` | æ— éœ€è®¤è¯ | åˆ†ç±»æŸ¥è¯¢ |
| `GET /products/top-selling` | æ— éœ€è®¤è¯ | çƒ­é”€å•†å“ |
| `GET /products/newest` | æ— éœ€è®¤è¯ | æ–°å“å•†å“ |
| `GET /products/stats` | æ— éœ€è®¤è¯ | å•†å“ç»Ÿè®¡ |
| `GET /products/merchant/stats` | SHOPERè§’è‰² | å•†å®¶ç»Ÿè®¡ |

### å•†å“æ“ä½œæ¥å£
| æ¥å£ | æƒé™è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| `POST /products` | SHOPERè§’è‰² | åˆ›å»ºå•†å“ |
| `PUT /products/{id}` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…) | æ›´æ–°å•†å“ |
| `DELETE /products/{id}` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…)æˆ–ADMIN | åˆ é™¤å•†å“ |
| `PUT /products/{id}/status` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…) | å•†å“çŠ¶æ€åˆ‡æ¢ |
| `PUT /products/{id}/stock` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…) | åº“å­˜æ›´æ–° |
| `PUT /products/{id}/price` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…) | ä»·æ ¼æ›´æ–° |
| `PUT /products/{id}/discount` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…) | æŠ˜æ‰£æ›´æ–° |
| `POST /products/{id}/image` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…) | ä¸Šä¼ å•†å“å›¾ç‰‡ |
| `DELETE /products/{id}/image` | SHOPERè§’è‰²(å•†å“åˆ›å»ºè€…) | åˆ é™¤å•†å“å›¾ç‰‡ |

### æ‰¹é‡æ“ä½œæ¥å£
| æ¥å£ | æƒé™è¦æ±‚ | è¯´æ˜ |
|------|----------|------|
| `POST /products/batch/publish` | SHOPERè§’è‰² | æ‰¹é‡ä¸Šæ¶ |
| `POST /products/batch/unpublish` | SHOPERè§’è‰² | æ‰¹é‡ä¸‹æ¶ |
| `POST /products/batch/delete` | SHOPERè§’è‰²æˆ–ADMIN | æ‰¹é‡åˆ é™¤ |

## âš ï¸ æƒé™é”™è¯¯å¤„ç†

å½“ç”¨æˆ·å°è¯•è®¿é—®æ²¡æœ‰æƒé™çš„æ¥å£æ—¶ï¼Œå°†è¿”å›ä»¥ä¸‹é”™è¯¯å“åº”ï¼š

### é”™è¯¯å“åº”ç¤ºä¾‹

```json
{
  "success": false,
  "code": 403,
  "message": "æƒé™ä¸è¶³ï¼Œæ— æ³•è®¿é—®æ­¤èµ„æº",
  "data": null
}
```

## ğŸ§ª å‰ç«¯æƒé™æ£€æŸ¥ç¤ºä¾‹

```javascript
import { useAuthStore } from '@/stores/auth'

// æƒé™æ£€æŸ¥å‡½æ•°
function hasPermission(requiredRole) {
  const authStore = useAuthStore()
  const userRole = authStore.user?.role

  if (!userRole) return false

  // æƒé™å±‚çº§: ADMIN > SHOPER > USER
  const roleHierarchy = {
    'USER': 1,
    'SHOPER': 2,
    'ADMIN': 3
  }

  return roleHierarchy[userRole] >= roleHierarchy[requiredRole]
}

// ä½¿ç”¨ç¤ºä¾‹
if (hasPermission('SHOPER')) {
  console.log('ç”¨æˆ·æœ‰å•†å®¶æƒé™')
  // æ˜¾ç¤ºå•†å®¶åŠŸèƒ½
} else {
  console.log('ç”¨æˆ·æ²¡æœ‰å•†å®¶æƒé™')
  // éšè—å•†å®¶åŠŸèƒ½æˆ–æç¤ºå‡çº§
}
```