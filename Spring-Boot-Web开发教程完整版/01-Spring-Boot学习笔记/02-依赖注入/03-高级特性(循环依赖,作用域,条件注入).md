---
tags:
  - ä¾èµ–æ³¨å…¥
  - å¾ªç¯ä¾èµ–
  - Beanä½œç”¨åŸŸ
  - æ¡ä»¶æ³¨å…¥
  - é«˜çº§ç‰¹æ€§
  - @Lazy
  - @Scope
created: 2025-11-16
modified: 2025-11-16
category: ä¾èµ–æ³¨å…¥
difficulty: advanced
---

# é«˜çº§ç‰¹æ€§ï¼šå¾ªç¯ä¾èµ–ã€ä½œç”¨åŸŸã€æ¡ä»¶æ³¨å…¥

## ğŸ”„ å¾ªç¯ä¾èµ–æ·±åº¦è§£æ

### ä»€ä¹ˆæ˜¯å¾ªç¯ä¾èµ–ï¼Ÿ

å¾ªç¯ä¾èµ–æ˜¯æŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªBeanç›¸äº’ä¾èµ–ï¼Œå½¢æˆé—­ç¯çš„æƒ…å†µã€‚Springä½¿ç”¨**ä¸‰çº§ç¼“å­˜**æœºåˆ¶æ¥è§£å†³éƒ¨åˆ†å¾ªç¯ä¾èµ–é—®é¢˜ã€‚

### Springå¦‚ä½•è§£å†³å¾ªç¯ä¾èµ–ï¼Ÿ

**A:** Springä½¿ç”¨**ä¸‰çº§ç¼“å­˜**æœºåˆ¶è§£å†³setteræ³¨å…¥çš„å¾ªç¯ä¾èµ–ï¼š

```java
// Springå®¹å™¨å†…éƒ¨ç®€åŒ–å®ç°
public class DefaultSingletonBeanRegistry {

    // ä¸€çº§ç¼“å­˜ï¼šå®Œå…¨åˆå§‹åŒ–çš„Bean
    private final Map<String, Object> singletonObjects = new ConcurrentHashMap<>();

    // äºŒçº§ç¼“å­˜ï¼šæå‰æš´éœ²çš„Beanï¼ˆæœªå®Œå…¨åˆå§‹åŒ–ï¼‰
    private final Map<String, Object> earlySingletonObjects = new HashMap<>();

    // ä¸‰çº§ç¼“å­˜ï¼šBeanå·¥å‚ï¼Œç”¨äºç”Ÿæˆä»£ç†å¯¹è±¡
    private final Map<String, ObjectFactory<?>> singletonFactories = new HashMap<>();

    protected Object getSingleton(String beanName) {
        // 1. ä»ä¸€çº§ç¼“å­˜è·å–
        Object singletonObject = this.singletonObjects.get(beanName);
        if (singletonObject == null) {
            // 2. ä»äºŒçº§ç¼“å­˜è·å–
            singletonObject = this.earlySingletonObjects.get(beanName);
            if (singletonObject == null) {
                // 3. ä»ä¸‰çº§ç¼“å­˜è·å–å¹¶åˆ›å»º
                ObjectFactory<?> singletonFactory = this.singletonFactories.get(beanName);
                if (singletonFactory != null) {
                    singletonObject = singletonFactory.getObject();
                    this.earlySingletonObjects.put(beanName, singletonObject);
                    this.singletonFactories.remove(beanName);
                }
            }
        }
        return singletonObject;
    }
}
```

### å¾ªç¯ä¾èµ–è§£å†³è¿‡ç¨‹

```java
// ç¤ºä¾‹ï¼šServiceAå’ŒServiceBå¾ªç¯ä¾èµ–
@Service
public class ServiceA {
    private ServiceB serviceB;

    @Autowired  // Setteræ³¨å…¥ï¼Œæ”¯æŒå¾ªç¯ä¾èµ–
    public void setServiceB(ServiceB serviceB) {
        this.serviceB = serviceB;
    }
}

@Service
public class ServiceB {
    private ServiceA serviceA;

    @Autowired  // Setteræ³¨å…¥ï¼Œæ”¯æŒå¾ªç¯ä¾èµ–
    public void setServiceA(ServiceA serviceA) {
        this.serviceA = serviceA;
    }
}

// è§£å†³æµç¨‹ï¼š
// 1. Springåˆ›å»ºServiceAå®ä¾‹ï¼ˆæœªåˆå§‹åŒ–ï¼‰
// 2. å°†ServiceAæ”¾å…¥ä¸‰çº§ç¼“å­˜
// 3. æ³¨å…¥ServiceBæ—¶ï¼Œå‘ç°éœ€è¦ServiceB
// 4. åˆ›å»ºServiceBå®ä¾‹ï¼Œæ”¾å…¥ä¸‰çº§ç¼“å­˜
// 5. æ³¨å…¥ServiceAæ—¶ï¼Œä»ä¸‰çº§ç¼“å­˜è·å–ServiceA
// 6. ServiceBåˆå§‹åŒ–å®Œæˆï¼Œæ”¾å…¥ä¸€çº§ç¼“å­˜
// 7. ServiceAæ³¨å…¥ServiceBï¼Œåˆå§‹åŒ–å®Œæˆï¼Œæ”¾å…¥ä¸€çº§ç¼“å­˜
```

### å“ªäº›å¾ªç¯ä¾èµ–æ— æ³•è§£å†³ï¼Ÿ

**A:** ä»¥ä¸‹æƒ…å†µSpringæ— æ³•è§£å†³ï¼š

```java
// âŒ 1. æ„é€ å‡½æ•°å¾ªç¯ä¾èµ– - æ— æ³•è§£å†³
@Service
public class ServiceA {
    private final ServiceB serviceB;

    public ServiceA(ServiceB serviceB) {  // æ„é€ å‡½æ•°éœ€è¦ServiceB
        this.serviceB = serviceB;
    }
}

@Service
public class ServiceB {
    private final ServiceA serviceA;

    public ServiceB(ServiceA serviceA) {  // æ„é€ å‡½æ•°éœ€è¦ServiceA
        this.serviceA = serviceA;
    }
}

// âŒ 2. @Asyncæ³¨è§£çš„å¾ªç¯ä¾èµ– - æ— æ³•è§£å†³
@Service
public class ServiceA {
    @Autowired
    private ServiceB serviceB;

    @Async  // ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œå¯¼è‡´å¾ªç¯ä¾èµ–
    public void methodA() { }
}

@Service
public class ServiceB {
    @Autowired
    private ServiceA serviceA;

    @Async  // ç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œå¯¼è‡´å¾ªç¯ä¾èµ–
    public void methodB() { }
}

// âœ… è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨@Lazy
@Service
public class ServiceA {
    private final ServiceB serviceB;

    public ServiceA(@Lazy ServiceB serviceB) {  // å»¶è¿ŸåŠ è½½
        this.serviceB = serviceB;
    }
}
```

### å¾ªç¯ä¾èµ–çš„è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1ï¼šä½¿ç”¨@Lazyå»¶è¿Ÿåˆå§‹åŒ–

```java
@Service
public class ServiceA {
    private final ServiceB serviceB;

    public ServiceA(@Lazy ServiceB serviceB) {
        this.serviceB = serviceB;
    }
}

@Service
public class ServiceB {
    private final ServiceA serviceA;

    public ServiceB(@Lazy ServiceA serviceA) {
        this.serviceA = serviceA;
    }
}
```

#### æ–¹æ¡ˆ2ï¼šé‡æ„è®¾è®¡ï¼Œæå–å…±åŒä¾èµ–

```java
@Service
public class SharedService {
    // å…±åŒé€»è¾‘
}

@Service
public class ServiceA {
    private final SharedService sharedService;
    public ServiceA(SharedService sharedService) {
        this.sharedService = sharedService;
    }
}

@Service
public class ServiceB {
    private final SharedService sharedService;
    public ServiceB(SharedService sharedService) {
        this.sharedService = sharedService;
    }
}
```

#### æ–¹æ¡ˆ3ï¼šä½¿ç”¨ApplicationContextåŠ¨æ€è·å–

```java
@Service
public class ServiceA {
    @Autowired
    private ApplicationContext applicationContext;

    private ServiceB serviceB;

    @PostConstruct
    public void init() {
        // å»¶è¿Ÿè·å–ï¼Œé¿å…å¾ªç¯ä¾èµ–
        this.serviceB = applicationContext.getBean(ServiceB.class);
    }
}
```

---

## ğŸ¯ Beanä½œç”¨åŸŸè¯¦è§£

### ä½œç”¨åŸŸç±»å‹å’Œé€‰æ‹©

| ä½œç”¨åŸŸ | æè¿° | ç”Ÿå‘½å‘¨æœŸ | é€‚ç”¨åœºæ™¯ | æ˜¯å¦çº¿ç¨‹å®‰å…¨ |
|--------|------|----------|----------|-------------|
| **singleton** | é»˜è®¤ï¼Œæ•´ä¸ªåº”ç”¨åªæœ‰ä¸€ä¸ªå®ä¾‹ | åº”ç”¨å¯åŠ¨æ—¶åˆ›å»ºï¼Œåº”ç”¨å…³é—­æ—¶é”€æ¯ | æ— çŠ¶æ€æœåŠ¡ï¼ˆæ¨èï¼‰ | éœ€è¦ä¿è¯ |
| **prototype** | æ¯æ¬¡æ³¨å…¥éƒ½åˆ›å»ºæ–°å®ä¾‹ | æ¯æ¬¡è¯·æ±‚æ—¶åˆ›å»ºï¼Œç”±GCå›æ”¶ | æœ‰çŠ¶æ€å¯¹è±¡ | ä¸é€‚ç”¨ |
| **request** | Webåº”ç”¨ï¼Œæ¯ä¸ªHTTPè¯·æ±‚ä¸€ä¸ªå®ä¾‹ | è¯·æ±‚å¼€å§‹åˆ›å»ºï¼Œè¯·æ±‚ç»“æŸé”€æ¯ | è¯·æ±‚ç›¸å…³æ•°æ® | çº¿ç¨‹éš”ç¦» |
| **session** | Webåº”ç”¨ï¼Œæ¯ä¸ªHTTPä¼šè¯ä¸€ä¸ªå®ä¾‹ | ä¼šè¯å¼€å§‹åˆ›å»ºï¼Œä¼šè¯ç»“æŸé”€æ¯ | ç”¨æˆ·ä¼šè¯æ•°æ® | ä¼šè¯éš”ç¦» |

### ä½œç”¨åŸŸä½¿ç”¨ç¤ºä¾‹

```java
// âœ… é»˜è®¤singleton - æ— çŠ¶æ€æœåŠ¡
@Service
@Scope("singleton")  // å¯çœç•¥ï¼Œè¿™æ˜¯é»˜è®¤å€¼
public class UserService {
    // æ— çŠ¶æ€ï¼Œçº¿ç¨‹å®‰å…¨
    public User findUser(Long id) {
        // ä¸šåŠ¡é€»è¾‘ï¼Œä¸ä¿å­˜çŠ¶æ€
    }
}

// âœ… prototype - æœ‰çŠ¶æ€å¯¹è±¡
@Component
@Scope("prototype")
public class ShoppingCart {
    private List<Item> items = new ArrayList<>();
    private BigDecimal total = BigDecimal.ZERO;

    // æ¯æ¬¡æ³¨å…¥éƒ½æ˜¯æ–°çš„è´­ç‰©è½¦
    public void addItem(Item item) {
        items.add(item);
        total = total.add(item.getPrice());
    }

    public BigDecimal getTotal() {
        return total;
    }
}

// âœ… request - è¯·æ±‚ä½œç”¨åŸŸ
@Component
@Scope(value = WebApplicationContext.SCOPE_REQUEST, proxyMode = ScopedProxyMode.TARGET_CLASS)
public class RequestData {
    private String requestId;
    private User currentUser;

    // æ¯ä¸ªHTTPè¯·æ±‚ä¸€ä¸ªå®ä¾‹
    public void setRequestId(String requestId) {
        this.requestId = requestId;
    }
}

// âœ… session - ä¼šè¯ä½œç”¨åŸŸ
@Component
@Scope(value = WebApplicationContext.SCOPE_SESSION, proxyMode = ScopedProxyMode.TARGET_CLASS)
public class UserSession {
    private User currentUser;
    private List<String> permissions;

    // æ¯ä¸ªç”¨æˆ·ä¼šè¯ä¸€ä¸ªå®ä¾‹
    public void login(User user) {
        this.currentUser = user;
    }
}
```

### ä½œç”¨åŸŸä»£ç†æ¨¡å¼

å½“singleton Beanä¾èµ–prototypeæˆ–requestä½œç”¨åŸŸBeanæ—¶ï¼Œéœ€è¦ä½¿ç”¨ä»£ç†æ¨¡å¼ï¼š

```java
@Service
public class SingletonService {

    @Autowired
    private PrototypeBean prototypeBean;  // éœ€è¦ä»£ç†æ¨¡å¼

    public void doSomething() {
        // æ¯æ¬¡è°ƒç”¨éƒ½ä¼šåˆ›å»ºæ–°çš„prototypeBeanå®ä¾‹
        prototypeBean.execute();
    }
}

@Component
@Scope(value = "prototype", proxyMode = ScopedProxyMode.TARGET_CLASS)
public class PrototypeBean {
    public void execute() {
        System.out.println("PrototypeBeanå®ä¾‹: " + this.hashCode());
    }
}
```

### è‡ªå®šä¹‰ä½œç”¨åŸŸ

```java
// è‡ªå®šä¹‰ä½œç”¨åŸŸ
public class ThreadScope implements Scope {

    private final ThreadLocal<Object> threadObjects = new ThreadLocal<>();

    @Override
    public Object get(String name, ObjectFactory<?> objectFactory) {
        Object object = threadObjects.get();
        if (object == null) {
            object = objectFactory.getObject();
            threadObjects.set(object);
        }
        return object;
    }

    @Override
    public Object remove(String name) {
        threadObjects.remove();
        return null;
    }

    // å…¶ä»–æ–¹æ³•å®ç°...
}

// æ³¨å†Œè‡ªå®šä¹‰ä½œç”¨åŸŸ
@Configuration
public class ScopeConfig {

    @Bean
    public static CustomScopeConfigurer customScopeConfigurer() {
        CustomScopeConfigurer configurer = new CustomScopeConfigurer();
        configurer.addScope("thread", new ThreadScope());
        return configurer;
    }
}

// ä½¿ç”¨è‡ªå®šä¹‰ä½œç”¨åŸŸ
@Component
@Scope("thread")
public class ThreadScopedBean {
    // æ¯ä¸ªçº¿ç¨‹ä¸€ä¸ªå®ä¾‹
}
```

---

## ğŸ”§ æ¡ä»¶æ³¨å…¥å’Œæ¡ä»¶åŒ–Bean

### åŸºäºå±æ€§çš„æ¡ä»¶æ³¨å…¥

```java
@Service
@ConditionalOnProperty(name = "cache.enabled", havingValue = "true")
public class RedisCacheService implements CacheService {
    // Redisç¼“å­˜å®ç°
}

@Service
@ConditionalOnProperty(name = "cache.enabled", havingValue = "false", matchIfMissing = true)
public class MemoryCacheService implements CacheService {
    // å†…å­˜ç¼“å­˜å®ç°
}
```

### åŸºäºç±»çš„æ¡ä»¶æ³¨å…¥

```java
@Configuration
@ConditionalOnClass(name = "redis.clients.jedis.Jedis")
public class RedisConfig {

    @Bean
    @ConditionalOnMissingBean
    public RedisTemplate<String, Object> redisTemplate() {
        return new RedisTemplate<>();
    }
}

@Configuration
@ConditionalOnMissingClass("redis.clients.jedis.Jedis")
public class MemoryConfig {

    @Bean
    public CacheManager cacheManager() {
        return new ConcurrentMapCacheManager();
    }
}
```

### åŸºäºBeançš„æ¡ä»¶æ³¨å…¥

```java
@Configuration
@ConditionalOnBean(DataSource.class)
public class DatabaseConfig {

    @Bean
    public JdbcTemplate jdbcTemplate(DataSource dataSource) {
        return new JdbcTemplate(dataSource);
    }
}

@Configuration
@ConditionalOnMissingBean(DataSource.class)
public class NoDatabaseConfig {

    @Bean
    public MapDataSource mapDataSource() {
        return new MapDataSource();
    }
}
```

### è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£

```java
// è‡ªå®šä¹‰æ¡ä»¶æ³¨è§£
@Target({ElementType.TYPE, ElementType.METHOD})
@Retention(RetentionPolicy.RUNTIME)
@Conditional(OnCustomCondition.class)
public @interface ConditionalOnCustomFeature {
    String value() default "";
}

// è‡ªå®šä¹‰æ¡ä»¶å®ç°
public class OnCustomCondition implements Condition {

    @Override
    public boolean matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
        String feature = metadata.getAnnotationAttributes(ConditionalOnCustomFeature.class.getName())
                               .get("value").toString();

        // è‡ªå®šä¹‰æ¡ä»¶é€»è¾‘
        String enabledFeatures = context.getEnvironment().getProperty("custom.features");
        return enabledFeatures != null && enabledFeatures.contains(feature);
    }
}

// ä½¿ç”¨è‡ªå®šä¹‰æ¡ä»¶
@Configuration
public class CustomConfig {

    @Bean
    @ConditionalOnCustomFeature("advanced")
    public AdvancedService advancedService() {
        return new AdvancedService();
    }

    @Bean
    @ConditionalOnCustomFeature("basic")
    public BasicService basicService() {
        return new BasicService();
    }
}
```

---

## ğŸš¨ é«˜çº§æ³¨å…¥æ¨¡å¼

### æ³›å‹æ³¨å…¥

```java
// åŸºç¡€æ³›å‹æ¥å£
public interface Repository<T> {
    T save(T entity);
    Optional<T> findById(Long id);
}

// ä¸åŒç±»å‹çš„å®ç°
@Repository
public class UserRepository implements Repository<User> {
    @Override
    public User save(User user) { /* å®ç° */ }

    @Override
    public Optional<User> findById(Long id) { /* å®ç° */ }
}

@Repository
public class OrderRepository implements Repository<Order> {
    @Override
    public Order save(Order order) { /* å®ç° */ }

    @Override
    public Optional<Order> findById(Long id) { /* å®ç° */ }
}

// Springä¼šæ ¹æ®æ³›å‹å‚æ•°ç²¾ç¡®åŒ¹é…
@Service
public class DataService {
    @Autowired
    private Repository<User> userRepo;     // âœ… æ³¨å…¥UserRepository

    @Autowired
    private Repository<Order> orderRepo;   // âœ… æ³¨å…¥OrderRepository

    @Autowired
    private List<Repository<?>> allRepos;  // âœ… æ³¨å…¥æ‰€æœ‰Repositoryå®ç°
}
```

### å¤šå±‚æ³›å‹åŒ¹é…

```java
// å¤šå±‚æ³›å‹
public interface GenericService<T, ID> {
    T findById(ID id);
    List<T> findAll();
}

@Service
public class UserService implements GenericService<User, Long> {
    @Override
    public User findById(Long id) { return null; }

    @Override
    public List<User> findAll() { return null; }
}

@Service
public class ProductService implements GenericService<Product, String> {
    @Override
    public Product findById(String id) { return null; }

    @Override
    public List<Product> findAll() { return null; }
}

// ç²¾ç¡®åŒ¹é…
@Service
public class Controller {
    @Autowired
    private GenericService<User, Long> userService;     // âœ… ç²¾ç¡®åŒ¹é…

    @Autowired
    private GenericService<Product, String> productService; // âœ… ç²¾ç¡®åŒ¹é…
}
```

### é›†åˆæ³¨å…¥çš„é«˜çº§ç”¨æ³•

```java
@Service
public class ProcessorManager {

    // æ³¨å…¥æ‰€æœ‰å®ç°ï¼ŒæŒ‰@Orderæ’åº
    @Autowired
    private List<DataProcessor> processors;  // è‡ªåŠ¨æŒ‰@Orderæ’åº

    // æ³¨å…¥æ‰€æœ‰å®ç°ï¼ŒæŒ‰åç§°æ˜ å°„
    @Autowired
    private Map<String, DataProcessor> processorMap;  // {beanName=instance}

    // ç»“åˆæ³›å‹æ³¨å…¥
    @Autowired
    private List<Handler<Message>> messageHandlers;

    // æŒ‰æ¡ä»¶è¿‡æ»¤æ³¨å…¥
    @Autowired
    private List<Processor> enabledProcessors;

    public void processData(Data data) {
        // æŒ‰é¡ºåºæ‰§è¡Œæ‰€æœ‰å¤„ç†å™¨
        processors.forEach(processor -> processor.process(data));
    }

    public DataProcessor getProcessor(String name) {
        return processorMap.get(name);
    }
}

// å¤„ç†å™¨å®ç°
@Component
@Order(1)
public class ValidationProcessor implements DataProcessor {
    @Override
    public void process(Data data) {
        // éªŒè¯é€»è¾‘
    }
}

@Component
@Order(2)
public class TransformationProcessor implements DataProcessor {
    @Override
    public void process(Data data) {
        // è½¬æ¢é€»è¾‘
    }
}
```

---

## ğŸ” è‡ªå®šä¹‰ä¾èµ–æ³¨å…¥é€»è¾‘

### å®ç°SmartInstantiationAwareBeanPostProcessor

```java
@Component
public class CustomAutowireProcessor implements SmartInstantiationAwareBeanPostProcessor {

    @Override
    public PropertyValues postProcessPropertyValues(
            PropertyValues pvs, PropertyDescriptor[] pds, Object bean, String beanName) {

        // è‡ªå®šä¹‰æ³¨å…¥é€»è¾‘
        if (bean instanceof RequiresSpecialInjection) {
            // æ‰§è¡Œç‰¹æ®Šçš„æ³¨å…¥é€»è¾‘
            performSpecialInjection((RequiresSpecialInjection) bean);
        }

        return pvs;
    }

    @Override
    public Object getEarlyBeanReference(Object bean, String beanName) {
        // æå‰æš´éœ²Beanå¼•ç”¨
        return bean;
    }

    private void performSpecialInjection(RequiresSpecialInjection bean) {
        // å®ç°ç‰¹æ®Šæ³¨å…¥é€»è¾‘
    }
}
```

### è‡ªå®šä¹‰Qualifieræ³¨è§£

```java
// è‡ªå®šä¹‰Qualifieræ³¨è§£
@Target({ElementType.FIELD, ElementType.PARAMETER, ElementType.TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Qualifier
public @interface FastService {
    String value() default "";
}

// ä½¿ç”¨è‡ªå®šä¹‰Qualifier
@Service("fastUserService")
@FastService("user")
public class FastUserServiceImpl implements UserService {
    // å¿«é€Ÿå®ç°
}

@Service("slowUserService")
public class SlowUserServiceImpl implements UserService {
    // æ…¢é€Ÿå®ç°
}

// æ³¨å…¥æ—¶ä½¿ç”¨è‡ªå®šä¹‰Qualifier
@Service
public class Controller {
    @Autowired
    @FastService("user")
    private UserService userService;  // æ³¨å…¥FastUserServiceImpl
}
```

---

## ğŸ“š ç›¸å…³æ¦‚å¿µäº¤å‰å¼•ç”¨

- [[01-æ ¸å¿ƒæ¦‚å¿µ(IoCå®¹å™¨,Beanç”Ÿå‘½å‘¨æœŸç­‰)]] - äº†è§£Beanç”Ÿå‘½å‘¨æœŸåŸºç¡€
- [[02-æ³¨å…¥æ–¹å¼(æ„é€ å‡½æ•°,å­—æ®µ,Setteræ³¨å…¥)]] - æŒæ¡åŸºæœ¬æ³¨å…¥æ–¹å¼
- [[04-é—®é¢˜æ’æŸ¥(NoSuchBeanDefinitionExceptionç­‰)]] - è§£å†³é«˜çº§ç‰¹æ€§é—®é¢˜

## ğŸ¯ æ ¸å¿ƒè¦ç‚¹æ€»ç»“

1. **å¾ªç¯ä¾èµ–**ï¼šSpringé€šè¿‡ä¸‰çº§ç¼“å­˜è§£å†³setteræ³¨å…¥å¾ªç¯ä¾èµ–ï¼Œæ„é€ å‡½æ•°å¾ªç¯ä¾èµ–æ— æ³•è§£å†³
2. **ä½œç”¨åŸŸé€‰æ‹©**ï¼šæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©åˆé€‚ä½œç”¨åŸŸï¼Œsingletonç”¨äºæ— çŠ¶æ€ï¼Œprototypeç”¨äºæœ‰çŠ¶æ€
3. **æ¡ä»¶æ³¨å…¥**ï¼šä½¿ç”¨@ConditionalOn*æ³¨è§£å®ç°åŸºäºç¯å¢ƒã€ç±»ã€Beançš„æ¡ä»¶åŒ–æ³¨å…¥
4. **æ³›å‹æ³¨å…¥**ï¼šSpringæ”¯æŒåŸºäºæ³›å‹å‚æ•°çš„ç²¾ç¡®åŒ¹é…ï¼Œå®ç°ç±»å‹å®‰å…¨çš„ä¾èµ–æ³¨å…¥
5. **é«˜çº§æ¨¡å¼**ï¼šé›†åˆæ³¨å…¥ã€è‡ªå®šä¹‰æ³¨è§£ã€è‡ªå®šä¹‰å¤„ç†å™¨ç­‰é«˜çº§ç‰¹æ€§å¢å¼ºDIçµæ´»æ€§
6. **æœ€ä½³å®è·µ**ï¼šé¿å…å¾ªç¯ä¾èµ–ï¼Œåˆç†é€‰æ‹©ä½œç”¨åŸŸï¼Œä½¿ç”¨æ¡ä»¶åŒ–é…ç½®æé«˜çµæ´»æ€§

æŒæ¡è¿™äº›é«˜çº§ç‰¹æ€§ï¼Œèƒ½å¤Ÿæ„å»ºæ›´åŠ çµæ´»ã€å¯é…ç½®çš„Springåº”ç”¨ç¨‹åºï¼Œé€‚åº”å¤æ‚çš„ä¸šåŠ¡åœºæ™¯éœ€æ±‚ã€‚