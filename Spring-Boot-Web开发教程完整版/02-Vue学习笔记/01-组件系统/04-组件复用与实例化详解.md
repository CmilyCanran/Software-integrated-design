---
tags:
  - Vueç»„ä»¶
  - ç»„ä»¶å¤ç”¨
  - ç»„ä»¶å®ä¾‹
  - ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ
  - Vue3
  - ç»„ä»¶ç®¡ç†
created: 2025-11-18
modified: 2025-11-18
category: Vueæ ¸å¿ƒæ¦‚å¿µ
difficulty: intermediate
---

# Vueç»„ä»¶å¤ç”¨ä¸å®ä¾‹åŒ–è¯¦è§£

> **å­¦ä¹ ç›®æ ‡**ï¼šæ·±å…¥ç†è§£Vueç»„ä»¶çš„å¤ç”¨æœºåˆ¶ï¼ŒæŒæ¡ç»„ä»¶å®ä¾‹çš„ç‹¬ç«‹æ€§ï¼Œå­¦ä¼šé«˜æ•ˆçš„ç»„ä»¶å®ä¾‹åŒ–å’Œç®¡ç†

## ğŸ¯ æœ¬ç« æ¦‚è§ˆ

| å†…å®¹ | é¢„è®¡æ—¶é—´ | éš¾åº¦ | çŠ¶æ€ |
|------|----------|------|------|
| ç»„ä»¶å¤ç”¨æ¦‚å¿µ | 15åˆ†é’Ÿ | â­â­ | â³ |
| ç»„ä»¶å®ä¾‹ç‹¬ç«‹æ€§ | 20åˆ†é’Ÿ | â­â­â­ | â³ |
| åŠ¨æ€ç»„ä»¶ä¸å®ä¾‹åŒ– | 25åˆ†é’Ÿ | â­â­â­ | â³ |
| ç»„ä»¶æ± ä¸ç¼“å­˜ | 20åˆ†é’Ÿ | â­â­ | â³ |
| æ€§èƒ½ä¼˜åŒ–æŠ€å·§ | 20åˆ†é’Ÿ | â­â­â­ | â³ |

---

## ğŸ”„ ç»„ä»¶å¤ç”¨æ¦‚å¿µ

### ä»€ä¹ˆæ˜¯ç»„ä»¶å¤ç”¨ï¼Ÿ

ç»„ä»¶å¤ç”¨æ˜¯æŒ‡**åŒä¸€ä¸ªç»„ä»¶å®šä¹‰åˆ›å»ºå¤šä¸ªç‹¬ç«‹å®ä¾‹**çš„è¿‡ç¨‹ï¼Œæ¯ä¸ªå®ä¾‹éƒ½æœ‰è‡ªå·±çš„çŠ¶æ€å’Œæ•°æ®ï¼š

```javascript
// ç±»æ¯”ï¼šæ±½è½¦åˆ¶é€ 
// è®¾è®¡å›¾ â†’ ç»„ä»¶å®šä¹‰
// å®é™…æ±½è½¦ â†’ ç»„ä»¶å®ä¾‹

// æ¯è¾†è½¦éƒ½æœ‰ï¼š
// - ç‹¬ç«‹çš„å‘åŠ¨æœºï¼ˆç»„ä»¶å†…éƒ¨çŠ¶æ€ï¼‰
// - ç‹¬ç«‹çš„é‡Œç¨‹è¡¨ï¼ˆç»„ä»¶æ•°æ®ï¼‰
// - ç›¸åŒçš„åŠŸèƒ½ï¼ˆç»„ä»¶æ–¹æ³•ï¼‰
// - å¯ä»¥åŒæ—¶è¡Œé©¶ï¼ˆç‹¬ç«‹è¿è¡Œï¼‰
```

### å¤ç”¨çš„å±‚æ¬¡

#### 1. ä»£ç çº§å¤ç”¨
```vue
<!-- å®šä¹‰ä¸€ä¸ªå¯å¤ç”¨çš„ç»„ä»¶ -->
<template>
  <button
    :class="['btn', `btn-${type}`, { 'btn-loading': loading }]"
    :disabled="disabled || loading"
    @click="handleClick"
  >
    <span v-if="loading">â³</span>
    <slot></slot>
  </button>
</template>

<script setup>
// ä¸€ä¸ªç»„ä»¶å®šä¹‰ï¼Œå¯ä»¥åœ¨å¤šå¤„ä½¿ç”¨
defineProps({
  type: { type: String, default: 'primary' },
  loading: Boolean,
  disabled: Boolean
})

const emit = defineEmits(['click'])

function handleClick() {
  emit('click')
}
</script>
```

#### 2. å®ä¾‹çº§å¤ç”¨
```vue
<template>
  <div class="button-group">
    <!-- åŒä¸€ä¸ªç»„ä»¶å®šä¹‰ï¼Œä¸åŒçš„å®ä¾‹ -->
    <BaseButton type="primary">ä¿å­˜</BaseButton>
    <BaseButton type="secondary">å–æ¶ˆ</BaseButton>
    <BaseButton type="danger">åˆ é™¤</BaseButton>
    <BaseButton :loading="isSaving">æäº¤ä¸­...</BaseButton>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import BaseButton from './BaseButton.vue'

const isSaving = ref(false)
</script>
```

#### 3. é…ç½®çº§å¤ç”¨
```vue
<template>
  <div class="dashboard">
    <!-- é€šè¿‡ä¸åŒçš„é…ç½®å®ç°ä¸åŒçš„ç”¨é€” -->
    <BaseButton
      v-for="config in buttonConfigs"
      :key="config.id"
      :type="config.type"
      :disabled="config.disabled"
      @click="config.handler"
    >
      {{ config.text }}
    </BaseButton>
  </div>
</template>

<script setup>
import { ref } from 'vue'

// é€šè¿‡é…ç½®æ•°ç»„ç®¡ç†å¤šä¸ªæŒ‰é’®å®ä¾‹
const buttonConfigs = ref([
  {
    id: 1,
    type: 'primary',
    text: 'åˆ›å»º',
    disabled: false,
    handler: () => createItem()
  },
  {
    id: 2,
    type: 'warning',
    text: 'ç¼–è¾‘',
    disabled: true,  // æ¡ä»¶æ§åˆ¶
    handler: () => editItem()
  }
])

function createItem() {
  console.log('åˆ›å»ºé¡¹ç›®')
}

function editItem() {
  console.log('ç¼–è¾‘é¡¹ç›®')
}
</script>
```

---

## ğŸ—ï¸ ç»„ä»¶å®ä¾‹ç‹¬ç«‹æ€§

### å®ä¾‹ç‹¬ç«‹çš„ä½“ç°

æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æ˜¯å®Œå…¨ç‹¬ç«‹çš„ï¼Œæ‹¥æœ‰è‡ªå·±çš„çŠ¶æ€ã€æ•°æ®å’Œç”Ÿå‘½å‘¨æœŸï¼š

```vue
<!-- Counter.vue - è®¡æ•°å™¨ç»„ä»¶ -->
<template>
  <div class="counter">
    <h3>{{ title }}</h3>
    <p>å½“å‰è®¡æ•°ï¼š{{ count }}</p>
    <p>åˆ›å»ºæ—¶é—´ï¼š{{ createdAt }}</p>
    <button @click="increment">+1</button>
    <button @click="decrement">-1</button>
    <button @click="reset">é‡ç½®</button>
  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'

// æ¯ä¸ªå®ä¾‹éƒ½æœ‰ç‹¬ç«‹çš„count
const count = ref(0)
const createdAt = ref('')

const props = defineProps({
  title: {
    type: String,
    default: 'è®¡æ•°å™¨'
  }
})

// æ¯ä¸ªå®ä¾‹ç‹¬ç«‹æ‰§è¡Œ
onMounted(() => {
  createdAt.value = new Date().toLocaleTimeString()
  console.log(`${props.title} å·²åˆ›å»ºï¼Œåˆå§‹å€¼ï¼š${count.value}`)
})

// æ¯ä¸ªå®ä¾‹çš„æ–¹æ³•éƒ½ç‹¬ç«‹æ“ä½œè‡ªå·±çš„çŠ¶æ€
function increment() {
  count.value++
  console.log(`${props.title} å¢åŠ åˆ°ï¼š${count.value}`)
}

function decrement() {
  count.value--
  console.log(`${props.title} å‡å°‘åˆ°ï¼š${count.value}`)
}

function reset() {
  count.value = 0
  console.log(`${props.title} å·²é‡ç½®`)
}
</script>

<style scoped>
.counter {
  border: 1px solid #ddd;
  border-radius: 8px;
  padding: 15px;
  margin: 10px;
  background: white;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.counter h3 {
  margin: 0 0 10px 0;
  color: #333;
}

.counter button {
  margin: 0 5px;
  padding: 5px 10px;
}
</style>
```

```vue
<!-- App.vue - ä½¿ç”¨å¤šä¸ªè®¡æ•°å™¨å®ä¾‹ -->
<template>
  <div class="app">
    <h1>è®¡æ•°å™¨åº”ç”¨</h1>

    <!-- æ¯ä¸ªCounteréƒ½æ˜¯ç‹¬ç«‹çš„å®ä¾‹ -->
    <Counter title="åŸºç¡€è®¡æ•°å™¨" />
    <Counter title="é«˜çº§è®¡æ•°å™¨" />
    <Counter title="å¤‡ç”¨è®¡æ•°å™¨" />

    <div class="summary">
      <h3>å®ä¾‹æ€»ç»“</h3>
      <p>æ€»å…±åˆ›å»ºçš„è®¡æ•°å™¨å®ä¾‹ï¼š{{ counterInstances.length }}</p>
    </div>
  </div>
</template>

<script setup>
import { ref } from 'vue'
import Counter from './Counter.vue'

// å­˜å‚¨æ‰€æœ‰è®¡æ•°å™¨å®ä¾‹çš„å¼•ç”¨
const counterInstances = ref([])
</script>
```

### å®ä¾‹é—´çš„éš”ç¦»æœºåˆ¶

#### æ•°æ®éš”ç¦»

```vue
<!-- TodoItem.vue - å¾…åŠäº‹é¡¹ç»„ä»¶ -->
<template>
  <div class="todo-item" :class="{ completed: todo.completed }">
    <input
      v-model="localTodo.completed"
      type="checkbox"
      @change="handleToggle"
    >
    <span v-if="!isEditing" @dblclick="startEdit">
      {{ localTodo.text }}
    </span>
    <input
      v-else
      v-model="editText"
      @blur="finishEdit"
      @keyup.enter="finishEdit"
      class="edit-input"
    >
    <button @click="remove">åˆ é™¤</button>
  </div>
</template>

<script setup>
import { ref, watch } from 'vue'

const props = defineProps({
  todo: {
    type: Object,
    required: true
  }
})

const emit = defineEmits(['toggle', 'update', 'remove'])

// åˆ›å»ºæœ¬åœ°å‰¯æœ¬ï¼Œé¿å…ç›´æ¥ä¿®æ”¹Props
const localTodo = ref({ ...props.todo })
const isEditing = ref(false)
const editText = ref(props.todo.text)

// ç›‘å¬Propså˜åŒ–ï¼Œæ›´æ–°æœ¬åœ°å‰¯æœ¬
watch(() => props.todo, (newTodo) => {
  localTodo.value = { ...newTodo }
}, { deep: true })

function handleToggle() {
  emit('toggle', localTodo.value)
}

function startEdit() {
  isEditing.value = true
  editText.value = localTodo.value.text
}

function finishEdit() {
  isEditing.value = false
  if (editText.value !== localTodo.value.text) {
    const updatedTodo = { ...localTodo.value, text: editText.value }
    localTodo.value = updatedTodo
    emit('update', updatedTodo)
  }
}

function remove() {
  emit('remove', localTodo.value.id)
}
</script>
```

#### äº‹ä»¶éš”ç¦»

```vue
<!-- çˆ¶ç»„ä»¶ä¸­ä½¿ç”¨å¤šä¸ªTodoItemå®ä¾‹ -->
<template>
  <div class="todo-list">
    <TodoItem
      v-for="todo in todos"
      :key="todo.id"
      :todo="todo"
      @toggle="handleToggle"
      @update="handleUpdate"
      @remove="handleRemove"
    />
  </div>
</template>

<script setup>
import { ref } from 'vue'
import TodoItem from './TodoItem.vue'

const todos = ref([
  { id: 1, text: 'å­¦ä¹ Vueç»„ä»¶', completed: false },
  { id: 2, text: 'ç¼–å†™ä»£ç ', completed: true },
  { id: 3, text: 'æµ‹è¯•åŠŸèƒ½', completed: false }
])

// æ¯ä¸ªäº‹ä»¶éƒ½çŸ¥é“æ˜¯æ¥è‡ªå“ªä¸ªå…·ä½“çš„ç»„ä»¶å®ä¾‹
function handleToggle(todo) {
  console.log(`åˆ‡æ¢å¾…åŠäº‹é¡¹ï¼š${todo.text} (ID: ${todo.id})`)
  const index = todos.value.findIndex(t => t.id === todo.id)
  if (index !== -1) {
    todos.value[index] = todo
  }
}

function handleUpdate(updatedTodo) {
  console.log(`æ›´æ–°å¾…åŠäº‹é¡¹ï¼š${updatedTodo.text} (ID: ${updatedTodo.id})`)
  const index = todos.value.findIndex(t => t.id === updatedTodo.id)
  if (index !== -1) {
    todos.value[index] = updatedTodo
  }
}

function handleRemove(todoId) {
  console.log(`åˆ é™¤å¾…åŠäº‹é¡¹ (ID: ${todoId})`)
  todos.value = todos.value.filter(todo => todo.id !== todoId)
}
</script>
```

---

## âš¡ åŠ¨æ€ç»„ä»¶ä¸å®ä¾‹åŒ–

### åŠ¨æ€ç»„ä»¶åŸºç¡€

ä½¿ç”¨`<component :is="">`å®ç°ç»„ä»¶çš„åŠ¨æ€åˆ‡æ¢å’Œå®ä¾‹åŒ–ï¼š

```vue
<template>
  <div class="component-switcher">
    <div class="tabs">
      <button
        v-for="tab in tabs"
        :key="tab.name"
        :class="{ active: currentTab === tab.name }"
        @click="switchTab(tab)"
      >
        {{ tab.label }}
      </button>
    </div>

    <!-- åŠ¨æ€ç»„ä»¶ï¼šæ ¹æ®currentTabåˆ‡æ¢ä¸åŒçš„ç»„ä»¶å®ä¾‹ -->
    <component
      :is="currentComponent"
      :key="currentTab"
      v-bind="currentTabProps"
      @tab-change="handleTabChange"
    />
  </div>
</template>

<script setup>
import { ref, computed, shallowRef } from 'vue'

// å¯¼å…¥æ‰€æœ‰å¯èƒ½ä½¿ç”¨çš„ç»„ä»¶
import UserProfile from './UserProfile.vue'
import UserSettings from './UserSettings.vue'
import UserPosts from './UserPosts.vue'
import UserMessages from './UserMessages.vue'

// ä½¿ç”¨shallowRefé¿å…ä¸å¿…è¦çš„ç»„ä»¶é‡æ–°æ¸²æŸ“
const currentTab = ref('profile')

const tabs = ref([
  {
    name: 'profile',
    label: 'èµ„æ–™',
    component: UserProfile,
    props: { editable: true }
  },
  {
    name: 'settings',
    label: 'è®¾ç½®',
    component: UserSettings,
    props: { showAdvanced: false }
  },
  {
    name: 'posts',
    label: 'åŠ¨æ€',
    component: UserPosts,
    props: { limit: 10 }
  },
  {
    name: 'messages',
    label: 'æ¶ˆæ¯',
    component: UserMessages,
    props: { unreadOnly: false }
  }
])

// è®¡ç®—å½“å‰è¦æ¸²æŸ“çš„ç»„ä»¶
const currentComponent = computed(() => {
  const tab = tabs.value.find(t => t.name === currentTab.value)
  return tab ? tab.component : UserProfile
})

// è®¡ç®—å½“å‰ç»„ä»¶çš„Props
const currentTabProps = computed(() => {
  const tab = tabs.value.find(t => t.name === currentTab.value)
  return tab ? tab.props : {}
})

function switchTab(tab) {
  currentTab.value = tab.name
}

function handleTabChange(newTab) {
  currentTab.value = newTab
}
</script>

<style scoped>
.component-switcher {
  max-width: 800px;
  margin: 0 auto;
}

.tabs {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
  border-bottom: 1px solid #ddd;
}

.tabs button {
  padding: 10px 20px;
  border: none;
  background: none;
  cursor: pointer;
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
}

.tabs button.active {
  border-bottom-color: #42b883;
  color: #42b883;
}
</style>
```

### å¼‚æ­¥ç»„ä»¶å®ä¾‹åŒ–

ä½¿ç”¨`defineAsyncComponent`å®ç°ç»„ä»¶çš„å¼‚æ­¥åŠ è½½å’Œå®ä¾‹åŒ–ï¼š

```vue
<script setup>
import { defineAsyncComponent, ref } from 'vue'

// å¼‚æ­¥ç»„ä»¶å®šä¹‰
const AsyncUserProfile = defineAsyncComponent(() =>
  import('./UserProfile.vue')
)

// å¸¦é…ç½®çš„å¼‚æ­¥ç»„ä»¶
const AsyncUserSettings = defineAsyncComponent({
  loader: () => import('./UserSettings.vue'),
  loadingComponent: LoadingSpinner,
  errorComponent: ErrorMessage,
  delay: 200,
  timeout: 3000,
  suspensible: false
})

// å¤šä¸ªå¼‚æ­¥ç»„ä»¶
const componentMap = {
  profile: AsyncUserProfile,
  settings: AsyncUserSettings,
  posts: defineAsyncComponent(() => import('./UserPosts.vue')),
  messages: defineAsyncComponent(() => import('./UserMessages.vue'))
}

const currentComponent = ref('profile')
const isLoading = ref(false)

async function switchComponent(componentName) {
  isLoading.value = true
  try {
    currentComponent.value = componentName
    // ç»„ä»¶ä¼šåœ¨éœ€è¦æ—¶è‡ªåŠ¨åŠ è½½
  } catch (error) {
    console.error('åŠ è½½ç»„ä»¶å¤±è´¥ï¼š', error)
  } finally {
    isLoading.value = false
  }
}
</script>

<template>
  <div class="async-component-demo">
    <div class="component-selector">
      <button
        v-for="(component, name) in componentMap"
        :key="name"
        @click="switchComponent(name)"
        :disabled="currentComponent === name"
      >
        {{ name }}
      </button>
    </div>

    <div class="component-container">
      <!-- åŠ¨æ€æ¸²æŸ“å¼‚æ­¥ç»„ä»¶ -->
      <component
        :is="componentMap[currentComponent]"
        v-if="!isLoading"
        :key="currentComponent"
      />
      <div v-else class="loading">
        ç»„ä»¶åŠ è½½ä¸­...
      </div>
    </div>
  </div>
</template>
```

### ç»„ä»¶å®ä¾‹çš„åŠ¨æ€åˆ›å»º

#### ç¼–ç¨‹å¼ç»„ä»¶å®ä¾‹åŒ–

```vue
<script setup>
import { ref, createApp, onBeforeUnmount } from 'vue'
import MessageComponent from './MessageComponent.vue'

// åŠ¨æ€åˆ›å»ºç»„ä»¶å®ä¾‹
const containerRef = ref(null)
const instances = ref([])

function createMessage(type, text) {
  // åˆ›å»ºç»„ä»¶å®¹å™¨
  const container = document.createElement('div')
  containerRef.value.appendChild(container)

  // åˆ›å»ºVueåº”ç”¨å®ä¾‹
  const messageApp = createApp(MessageComponent, {
    type,
    text,
    onClose: () => {
      // ç»„ä»¶å…³é—­æ—¶æ¸…ç†å®ä¾‹
      messageApp.unmount()
      container.remove()
      instances.value = instances.value.filter(
        instance => instance.id !== messageApp._instance.uid
      )
    }
  })

  // æŒ‚è½½ç»„ä»¶
  const instance = messageApp.mount(container)
  instances.value.push({
    id: instance.uid,
    app: messageApp,
    container
  })

  return instance
}

// æ‰¹é‡åˆ›å»ºæ¶ˆæ¯
function createMultipleMessages() {
  createMessage('success', 'æ“ä½œæˆåŠŸï¼')
  createMessage('warning', 'è¯·æ³¨æ„æ£€æŸ¥æ•°æ®ï¼')
  createMessage('info', 'ç³»ç»Ÿæç¤ºä¿¡æ¯')
}

// æ¸…ç†æ‰€æœ‰å®ä¾‹
function clearAllMessages() {
  instances.value.forEach(instance => {
    instance.app.unmount()
    instance.container.remove()
  })
  instances.value = []
}

// ç»„ä»¶å¸è½½æ—¶æ¸…ç†æ‰€æœ‰å®ä¾‹
onBeforeUnmount(() => {
  clearAllMessages()
})
</script>

<template>
  <div class="message-demo">
    <div class="controls">
      <button @click="createMessage('success', 'æˆåŠŸæ¶ˆæ¯')">
        åˆ›å»ºæˆåŠŸæ¶ˆæ¯
      </button>
      <button @click="createMessage('error', 'é”™è¯¯æ¶ˆæ¯')">
        åˆ›å»ºé”™è¯¯æ¶ˆæ¯
      </button>
      <button @click="createMultipleMessages">
        åˆ›å»ºå¤šä¸ªæ¶ˆæ¯
      </button>
      <button @click="clearAllMessages">
        æ¸…ç†æ‰€æœ‰æ¶ˆæ¯
      </button>
    </div>

    <!-- åŠ¨æ€ç»„ä»¶å®¹å™¨ -->
    <div ref="containerRef" class="message-container"></div>

    <div class="info">
      <p>å½“å‰æ¶ˆæ¯å®ä¾‹æ•°ï¼š{{ instances.length }}</p>
    </div>
  </div>
</template>
```

---

## ğŸ’¾ ç»„ä»¶æ± ä¸ç¼“å­˜

### Keep-Aliveç¼“å­˜æœºåˆ¶

ä½¿ç”¨`<keep-alive>`ç¼“å­˜ç»„ä»¶å®ä¾‹ï¼Œé¿å…é‡å¤åˆ›å»ºå’Œé”€æ¯ï¼š

```vue
<template>
  <div class="tab-demo">
    <div class="tab-buttons">
      <button
        v-for="tab in tabs"
        :key="tab.name"
        :class="{ active: activeTab === tab.name }"
        @click="activeTab = tab.name"
      >
        {{ tab.label }}
      </button>
    </div>

    <!-- ä½¿ç”¨keep-aliveç¼“å­˜ç»„ä»¶å®ä¾‹ -->
    <keep-alive :include="cachedComponents">
      <component
        :is="currentTabComponent"
        :key="activeTab"
        @tab-data="handleTabData"
      />
    </keep-alive>

    <div class="debug-info">
      <h4>ç¼“å­˜ä¿¡æ¯</h4>
      <p>å½“å‰æ ‡ç­¾ï¼š{{ activeTab }}</p>
      <p>ç¼“å­˜çš„ç»„ä»¶ï¼š{{ cachedComponents.join(', ') }}</p>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted, onUnmounted } from 'vue'
import ProfileTab from './tabs/ProfileTab.vue'
import SettingsTab from './tabs/SettingsTab.vue'
import PostsTab from './tabs/PostsTab.vue'

const activeTab = ref('profile')
const tabData = ref({})
const cachedComponents = ref([])

const tabs = ref([
  { name: 'profile', label: 'ä¸ªäººèµ„æ–™', component: ProfileTab },
  { name: 'settings', label: 'è®¾ç½®', component: SettingsTab },
  { name: 'posts', label: 'åŠ¨æ€', component: PostsTab }
])

const currentTabComponent = computed(() => {
  const tab = tabs.value.find(t => t.name === activeTab.value)
  return tab ? tab.component : null
})

// ç›‘å¬ç¼“å­˜çŠ¶æ€
onMounted(() => {
  // æ¨¡æ‹Ÿæ·»åŠ åˆ°ç¼“å­˜
  setTimeout(() => {
    cachedComponents.value = ['ProfileTab', 'SettingsTab', 'PostsTab']
  }, 1000)
})

function handleTabData(data) {
  tabData.value[activeTab.value] = data
}
</script>

<style scoped>
.tab-demo {
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
}

.tab-buttons {
  display: flex;
  gap: 10px;
  margin-bottom: 20px;
}

.tab-buttons button {
  padding: 10px 20px;
  border: 1px solid #ddd;
  background: white;
  cursor: pointer;
}

.tab-buttons button.active {
  background: #42b883;
  color: white;
  border-color: #42b883;
}

.debug-info {
  margin-top: 20px;
  padding: 15px;
  background: #f5f5f5;
  border-radius: 8px;
}
</style>
```

### è‡ªå®šä¹‰ç»„ä»¶æ± 

å®ç°ä¸€ä¸ªæ›´çµæ´»çš„ç»„ä»¶æ± ç®¡ç†å™¨ï¼š

```vue
<script setup>
import { ref, shallowRef } from 'vue'

// ç»„ä»¶æ± ç®¡ç†å™¨
class ComponentPool {
  constructor() {
    this.pool = new Map()
    this.maxSize = 10
  }

  // è·å–æˆ–åˆ›å»ºç»„ä»¶å®ä¾‹
  getInstance(componentClass, props = {}) {
    const key = this.generateKey(componentClass, props)

    if (this.pool.has(key)) {
      // ä»æ± ä¸­è·å–å®ä¾‹
      const instance = this.pool.get(key)
      this.pool.delete(key)  // ç§»åˆ°æœ«å°¾ï¼ˆLRUï¼‰
      this.pool.set(key, instance)
      return instance
    } else {
      // åˆ›å»ºæ–°å®ä¾‹
      const instance = this.createInstance(componentClass, props)
      this.addToPool(key, instance)
      return instance
    }
  }

  // æ·»åŠ å®ä¾‹åˆ°æ± ä¸­
  addToPool(key, instance) {
    // å¦‚æœæ± æ»¡äº†ï¼Œç§»é™¤æœ€æ—§çš„å®ä¾‹
    if (this.pool.size >= this.maxSize) {
      const oldestKey = this.pool.keys().next().value
      const oldestInstance = this.pool.get(oldestKey)
      this.destroyInstance(oldestInstance)
      this.pool.delete(oldestKey)
    }

    this.pool.set(key, instance)
  }

  // åˆ›å»ºæ–°å®ä¾‹
  createInstance(componentClass, props) {
    // è¿™é‡Œç®€åŒ–å¤„ç†ï¼Œå®é™…å¯èƒ½éœ€è¦æ›´å¤æ‚çš„å®ä¾‹åˆ›å»ºé€»è¾‘
    return {
      component: componentClass,
      props,
      created: Date.now(),
      used: Date.now()
    }
  }

  // é”€æ¯å®ä¾‹
  destroyInstance(instance) {
    console.log('é”€æ¯ç»„ä»¶å®ä¾‹ï¼š', instance.component.name)
  }

  // ç”Ÿæˆç¼“å­˜é”®
  generateKey(componentClass, props) {
    const componentName = componentClass.name || 'Anonymous'
    const propsString = JSON.stringify(props)
    return `${componentName}:${propsString}`
  }

  // æ¸…ç†æ± 
  clear() {
    for (const instance of this.pool.values()) {
      this.destroyInstance(instance)
    }
    this.pool.clear()
  }

  // è·å–æ± çŠ¶æ€
  getStatus() {
    return {
      size: this.pool.size,
      maxSize: this.maxSize,
      instances: Array.from(this.pool.entries()).map(([key, instance]) => ({
        key,
        component: instance.component.name,
        created: instance.created,
        used: instance.used
      }))
    }
  }
}

// åˆ›å»ºç»„ä»¶æ± å®ä¾‹
const componentPool = new ComponentPool()

// æµ‹è¯•ç»„ä»¶æ± 
const currentInstance = ref(null)
const poolStatus = ref({})

function createTestInstance() {
  // æ¨¡æ‹Ÿç»„ä»¶ç±»
  class TestComponent {
    constructor(name) {
      this.name = name
    }
  }

  // ä»æ± ä¸­è·å–æˆ–åˆ›å»ºå®ä¾‹
  const instance = componentPool.getInstance(TestComponent, { name: 'Test' })
  currentInstance.value = instance
  updatePoolStatus()
}

function createMultipleInstances() {
  class ComponentA {}
  class ComponentB {}
  class ComponentC {}

  // åˆ›å»ºå¤šä¸ªä¸åŒç±»å‹çš„å®ä¾‹
  componentPool.getInstance(ComponentA, { type: 'A' })
  componentPool.getInstance(ComponentB, { type: 'B' })
  componentPool.getInstance(ComponentC, { type: 'C' })

  updatePoolStatus()
}

function updatePoolStatus() {
  poolStatus.value = componentPool.getStatus()
}

function clearPool() {
  componentPool.clear()
  currentInstance.value = null
  updatePoolStatus()
}
</script>

<template>
  <div class="component-pool-demo">
    <div class="controls">
      <button @click="createTestInstance">
        åˆ›å»ºæµ‹è¯•å®ä¾‹
      </button>
      <button @click="createMultipleInstances">
        åˆ›å»ºå¤šä¸ªå®ä¾‹
      </button>
      <button @click="updatePoolStatus">
        æ›´æ–°æ± çŠ¶æ€
      </button>
      <button @click="clearPool">
        æ¸…ç©ºç»„ä»¶æ± 
      </button>
    </div>

    <div class="status">
      <h3>å½“å‰å®ä¾‹</h3>
      <pre>{{ currentInstance }}</pre>

      <h3>æ± çŠ¶æ€</h3>
      <pre>{{ poolStatus }}</pre>
    </div>
  </div>
</template>
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–æŠ€å·§

### è™šæ‹Ÿåˆ—è¡¨ä¸­çš„ç»„ä»¶å®ä¾‹åŒ–

```vue
<template>
  <div class="virtual-list">
    <div
      class="virtual-scroll"
      :style="{ height: containerHeight + 'px' }"
      @scroll="handleScroll"
    >
      <div :style="{ height: totalHeight + 'px' }">
        <!-- åªæ¸²æŸ“å¯è§åŒºåŸŸçš„ç»„ä»¶å®ä¾‹ -->
        <div
          v-for="item in visibleItems"
          :key="item.id"
          class="list-item"
          :style="{
            transform: `translateY(${item.position}px)`,
            height: itemHeight + 'px'
          }"
        >
          <ListItem
            :item="item.data"
            :index="item.index"
            @item-click="handleItemClick"
          />
        </div>
      </div>
    </div>

    <div class="info">
      <p>æ€»é¡¹ç›®æ•°ï¼š{{ items.length }}</p>
      <p>å¯è§é¡¹ç›®æ•°ï¼š{{ visibleItems.length }}</p>
      <p>æ»šåŠ¨ä½ç½®ï¼š{{ scrollTop }}px</p>
    </div>
  </div>
</template>

<script setup>
import { ref, computed, onMounted } from 'vue'
import ListItem from './ListItem.vue'

const props = defineProps({
  items: {
    type: Array,
    required: true
  },
  itemHeight: {
    type: Number,
    default: 50
  },
  containerHeight: {
    type: Number,
    default: 400
  }
})

const scrollTop = ref(0)
const virtualContainer = ref(null)

// è®¡ç®—æ€»é«˜åº¦
const totalHeight = computed(() => {
  return props.items.length * props.itemHeight
})

// è®¡ç®—å¯è§åŒºåŸŸçš„èµ·å§‹ç´¢å¼•
const startIndex = computed(() => {
  return Math.floor(scrollTop.value / props.itemHeight)
})

// è®¡ç®—å¯è§åŒºåŸŸçš„ç»“æŸç´¢å¼•
const endIndex = computed(() => {
  const visibleCount = Math.ceil(props.containerHeight / props.itemHeight)
  return Math.min(
    startIndex.value + visibleCount + 5,  // ç¼“å†²åŒº
    props.items.length - 1
  )
})

// è®¡ç®—å¯è§é¡¹ç›®
const visibleItems = computed(() => {
  const items = []
  for (let i = startIndex.value; i <= endIndex.value; i++) {
    if (i < props.items.length) {
      items.push({
        id: props.items[i].id,
        index: i,
        data: props.items[i],
        position: i * props.itemHeight
      })
    }
  }
  return items
})

function handleScroll(event) {
  scrollTop.value = event.target.scrollTop
}

function handleItemClick(item, index) {
  console.log('ç‚¹å‡»é¡¹ç›®ï¼š', item, 'ç´¢å¼•ï¼š', index)
}
</script>

<style scoped>
.virtual-list {
  border: 1px solid #ddd;
  border-radius: 8px;
  overflow: hidden;
}

.virtual-scroll {
  overflow-y: auto;
  width: 100%;
}

.list-item {
  position: absolute;
  left: 0;
  right: 0;
  border-bottom: 1px solid #eee;
}

.info {
  padding: 15px;
  background: #f5f5f5;
  font-size: 14px;
}
</style>
```

### æ‡’åŠ è½½ç»„ä»¶å®ä¾‹

```vue
<script setup>
import { ref, defineAsyncComponent, shallowRef } from 'vue'

// æ‡’åŠ è½½ç»„ä»¶æ˜ å°„
const lazyComponents = {
  // åŸºç¡€æ‡’åŠ è½½
  BasicChart: defineAsyncComponent(() => import('./charts/BasicChart.vue')),

  // å¸¦åŠ è½½çŠ¶æ€çš„æ‡’åŠ è½½
  AdvancedChart: defineAsyncComponent({
    loader: () => import('./charts/AdvancedChart.vue'),
    loadingComponent: () => import('./LoadingPlaceholder.vue'),
    errorComponent: () => import('./ErrorPlaceholder.vue'),
    delay: 200,
    timeout: 5000
  }),

  // æ¡ä»¶æ‡’åŠ è½½
  ConditionalComponent: () => {
    return new Promise((resolve) => {
      // æ ¹æ®æ¡ä»¶å†³å®šæ˜¯å¦åŠ è½½
      if (window.innerWidth > 768) {
        import('./desktop/AdvancedUI.vue').then(resolve)
      } else {
        import('./mobile/SimpleUI.vue').then(resolve)
      }
    })
  }
}

// å½“å‰æ´»è·ƒçš„ç»„ä»¶
const activeComponents = shallowRef({})
const componentLoadTimes = ref({})

// æ‡’åŠ è½½ç»„ä»¶
async function loadComponent(name) {
  if (activeComponents.value[name]) {
    return activeComponents.value[name]
  }

  const startTime = performance.now()

  try {
    const component = await lazyComponents[name]()
    activeComponents.value[name] = component

    const loadTime = performance.now() - startTime
    componentLoadTimes.value[name] = loadTime.toFixed(2)

    console.log(`ç»„ä»¶ ${name} åŠ è½½å®Œæˆï¼Œè€—æ—¶ï¼š${loadTime}ms`)
    return component
  } catch (error) {
    console.error(`ç»„ä»¶ ${name} åŠ è½½å¤±è´¥ï¼š`, error)
    return null
  }
}

// é¢„åŠ è½½ç»„ä»¶
function preloadComponents(componentNames) {
  componentNames.forEach(name => {
    // åœ¨ç©ºé—²æ—¶é—´é¢„åŠ è½½
    if ('requestIdleCallback' in window) {
      requestIdleCallback(() => loadComponent(name))
    } else {
      setTimeout(() => loadComponent(name), 0)
    }
  })
}

// ç»„ä»¶ä½¿ç”¨ç¤ºä¾‹
const chartType = ref('basic')

async function switchChart(type) {
  chartType.value = type
  await loadComponent(type + 'Chart')
}

// åˆå§‹åŒ–é¢„åŠ è½½
preloadComponents(['BasicChart'])
</script>

<template>
  <div class="lazy-loading-demo">
    <div class="chart-controls">
      <button @click="switchChart('basic')">åŸºç¡€å›¾è¡¨</button>
      <button @click="switchChart('advanced')">é«˜çº§å›¾è¡¨</button>
    </div>

    <div class="chart-container">
      <!-- åŠ¨æ€åŠ è½½å’Œæ¸²æŸ“ç»„ä»¶ -->
      <component
        :is="activeComponents[chartType + 'Chart']"
        v-if="activeComponents[chartType + 'Chart']"
        :data="chartData"
      />
      <div v-else class="loading">
        å›¾è¡¨ç»„ä»¶åŠ è½½ä¸­...
      </div>
    </div>

    <div class="load-stats">
      <h4>ç»„ä»¶åŠ è½½ç»Ÿè®¡</h4>
      <div v-for="(time, name) in componentLoadTimes" :key="name" class="stat">
        {{ name }}: {{ time }}ms
      </div>
    </div>
  </div>
</template>
```

---

## ğŸ“ æœ¬ç« å°ç»“

### âœ… æŒæ¡çš„æ ¸å¿ƒæ¦‚å¿µ

1. **ç»„ä»¶å¤ç”¨** - åŒä¸€ç»„ä»¶å®šä¹‰åˆ›å»ºå¤šä¸ªç‹¬ç«‹å®ä¾‹
2. **å®ä¾‹ç‹¬ç«‹æ€§** - æ¯ä¸ªå®ä¾‹éƒ½æœ‰ç‹¬ç«‹çš„çŠ¶æ€å’Œæ•°æ®
3. **åŠ¨æ€å®ä¾‹åŒ–** - è¿è¡Œæ—¶åˆ›å»ºå’Œåˆ‡æ¢ç»„ä»¶å®ä¾‹
4. **ç»„ä»¶ç¼“å­˜** - keep-aliveå’Œè‡ªå®šä¹‰ç»„ä»¶æ± 
5. **æ€§èƒ½ä¼˜åŒ–** - è™šæ‹Ÿåˆ—è¡¨ã€æ‡’åŠ è½½ç­‰ä¼˜åŒ–æŠ€å·§

### ğŸ¯ å®è·µèƒ½åŠ›

- [ ] èƒ½å¤Ÿç†è§£ç»„ä»¶å®ä¾‹çš„ç‹¬ç«‹æ€§åŸç†
- [ ] èƒ½å¤Ÿå®ç°åŠ¨æ€ç»„ä»¶çš„åˆ›å»ºå’Œåˆ‡æ¢
- [ ] èƒ½å¤Ÿç®¡ç†ç»„ä»¶å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸ
- [ ] èƒ½å¤Ÿå®ç°ç»„ä»¶ç¼“å­˜å’Œæ± åŒ–ç®¡ç†
- [ ] èƒ½å¤Ÿä¼˜åŒ–å¤§é‡ç»„ä»¶å®ä¾‹çš„æ€§èƒ½

### ğŸš€ ä¸‹ä¸€æ­¥å­¦ä¹ 

æŒæ¡äº†ç»„ä»¶å¤ç”¨åï¼Œç»§ç»­å­¦ä¹ ï¼š
- [[06-Vueç»„ä»¶é€šä¿¡æœºåˆ¶è¯¦è§£.md|ç»„ä»¶é—´é€šä¿¡æœºåˆ¶]]
- [[07-Vueç»„ä»¶ç”Ÿå‘½å‘¨æœŸä¸é’©å­å‡½æ•°.md|ç»„ä»¶ç”Ÿå‘½å‘¨æœŸç®¡ç†]]
- [[08-Vueç»„ä»¶æœ€ä½³å®è·µ.md|ç»„ä»¶å¼€å‘æœ€ä½³å®è·µ]]

---

## ğŸ’¡ ç»„ä»¶å®ä¾‹ç®¡ç†é‡‘ç§‘ç‰å¾‹

1. **å®ä¾‹ç‹¬ç«‹** - æ°¸è¿œè®°ä½æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æ˜¯ç‹¬ç«‹çš„
2. **åˆç†å¤ç”¨** - é¿å…è¿‡åº¦å¤ç”¨ï¼Œå¿…è¦æ—¶åˆ›å»ºæ–°å®ä¾‹
3. **åŠæ—¶æ¸…ç†** - ç»„ä»¶é”€æ¯æ—¶æ¸…ç†æ‰€æœ‰èµ„æºå’Œäº‹ä»¶ç›‘å¬
4. **ç¼“å­˜ç­–ç•¥** - æ ¹æ®ä½¿ç”¨é¢‘ç‡å’Œæˆæœ¬åˆ¶å®šç¼“å­˜ç­–ç•¥
5. **æ€§èƒ½ä¼˜å…ˆ** - å¤§é‡å®ä¾‹æ—¶è€ƒè™‘è™šæ‹ŸåŒ–å’Œæ‡’åŠ è½½

**è®°ä½ï¼šç»„ä»¶å®ä¾‹åŒ–æ˜¯Vueçš„æ ¸å¿ƒç‰¹æ€§ï¼Œåˆç†çš„å®ä¾‹ç®¡ç†æ˜¯é«˜æ€§èƒ½åº”ç”¨çš„åŸºç¡€ï¼** ğŸ‰