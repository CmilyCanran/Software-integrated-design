---
tags:
  - å•†å“å®ä½“
  - JSONB
  - PostgreSQL
  - æ•°æ®å»ºæ¨¡
  - å®ä½“è®¾è®¡
created: 2025-12-01
modified: 2025-12-01
category: å¼€å‘æ•™ç¨‹
difficulty: intermediate
---

# 01-å•†å“å®ä½“è®¾è®¡

> **å­¦ä¹ ç›®æ ‡**ï¼šæŒæ¡ä¼ä¸šçº§å•†å“å®ä½“çš„è®¾è®¡å“²å­¦ï¼Œç†è§£PostgreSQL JSONBåœ¨åŠ¨æ€æ•°æ®å­˜å‚¨ä¸­çš„åº”ç”¨

## ğŸ¯ æœ¬ç« æ¦‚è§ˆ

**å­¦ä¹ æ—¶é—´**ï¼š45åˆ†é’Ÿ | **éš¾åº¦ç­‰çº§**ï¼šâ­â­â­ | **é‡ç‚¹ç¨‹åº¦**ï¼šğŸ”¥ğŸ”¥ğŸ”¥ğŸ”¥

å•†å“å®ä½“æ˜¯æ•´ä¸ªå•†å“ç®¡ç†ç³»ç»Ÿçš„æ ¸å¿ƒï¼Œå®ƒçš„è®¾è®¡è´¨é‡ç›´æ¥å†³å®šäº†ç³»ç»Ÿçš„æ‰©å±•æ€§å’Œç»´æŠ¤æ€§ã€‚æœ¬ç« å°†æ·±å…¥æ¢è®¨å¦‚ä½•è®¾è®¡ä¸€ä¸ªæ—¢ç¬¦åˆä¸šåŠ¡éœ€æ±‚åˆå…·å¤‡æŠ€æœ¯å‰ç»æ€§çš„å•†å“å®ä½“ã€‚

---

## ğŸ“‹ æ ¸å¿ƒéœ€æ±‚åˆ†æ

### ğŸª ä¸šåŠ¡åœºæ™¯ç†è§£

åœ¨ç”µå•†å¹³å°ä¸­ï¼Œå•†å“ä¿¡æ¯å…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

1. **å±æ€§å¤šæ ·åŒ–**ï¼šä¸åŒç±»åˆ«çš„å•†å“æœ‰ä¸åŒçš„å±æ€§ï¼ˆæœè£…æœ‰å°ºç ã€é¢œè‰²ï¼Œç”µå­äº§å“æœ‰é…ç½®å‚æ•°ï¼‰
2. **æ•°æ®åŠ¨æ€åŒ–**ï¼šå•†å“å±æ€§å¯èƒ½éšä¸šåŠ¡éœ€æ±‚å˜åŒ–è€Œå¢å‡
3. **ç»“æ„å¤æ‚åŒ–**ï¼šè§„æ ¼ã€å›¾ç‰‡ã€æè¿°ç­‰å¤šç§æ•°æ®ç±»å‹æ··åˆ
4. **æŸ¥è¯¢å¤šæ ·åŒ–**ï¼šéœ€è¦æ”¯æŒå„ç§å¤æ‚çš„æœç´¢å’Œç­›é€‰æ¡ä»¶

### ğŸ› ï¸ æŠ€æœ¯æŒ‘æˆ˜

ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“è®¾è®¡é¢ä¸´ä»¥ä¸‹æŒ‘æˆ˜ï¼š

| æŒ‘æˆ˜ | ä¼ ç»Ÿæ–¹æ¡ˆ | é—®é¢˜ |
|------|----------|------|
| åŠ¨æ€å±æ€§ | å¢åŠ å­—æ®µ | è¡¨ç»“æ„é¢‘ç¹å˜æ›´ï¼Œç»´æŠ¤å›°éš¾ |
| è§„æ ¼ç®¡ç† | å…³è”è¡¨è®¾è®¡ | æŸ¥è¯¢å¤æ‚ï¼Œæ€§èƒ½ä¸‹é™ |
| å›¾ç‰‡å­˜å‚¨ | å•ç‹¬è¡¨ç®¡ç† | æ•°æ®åˆ†æ•£ï¼Œä¸€è‡´æ€§éš¾ä¿è¯ |
| æ‰©å±•æ€§ | é¢„ç•™å­—æ®µ | ç©ºé—´æµªè´¹ï¼Œä¸å¤Ÿçµæ´» |

---

## ğŸ—ï¸ PostgreSQL JSONBè§£å†³æ–¹æ¡ˆ

### ğŸ’¡ JSONB vsä¼ ç»Ÿå…³ç³»å‹å­˜å‚¨

PostgreSQLæä¾›çš„JSONBç±»å‹ä¸ºæˆ‘ä»¬æä¾›äº†å®Œç¾çš„è§£å†³æ–¹æ¡ˆï¼š

```mermaid
graph LR
    A[å•†å“åŸºç¡€ä¿¡æ¯] --> B[å…³ç³»å‹å­—æ®µ]
    C[å•†å“æ‰©å±•ä¿¡æ¯] --> D[JSONBå­—æ®µ]
    B --> E[é«˜æ€§èƒ½æŸ¥è¯¢]
    D --> F[çµæ´»æ•°æ®ç»“æ„]
    E --> G[åº“å­˜ä»·æ ¼æŸ¥è¯¢]
    F --> H[åŠ¨æ€è§„æ ¼å±æ€§]
```

### ğŸ¯ æ··åˆå­˜å‚¨ç­–ç•¥

æˆ‘ä»¬çš„è®¾è®¡ç†å¿µæ˜¯ï¼š**åŸºç¡€ä¿¡æ¯ç”¨å…³ç³»å‹ï¼Œæ‰©å±•ä¿¡æ¯ç”¨JSONB**

```
â”Œâ”€ å…³ç³»å‹å­—æ®µï¼ˆå›ºå®šã€æŸ¥è¯¢é¢‘ç¹ï¼‰â”€â”    â”Œâ”€ JSONBå­—æ®µï¼ˆåŠ¨æ€ã€ç»“æ„å¤æ‚ï¼‰â”€â”
â”‚ id: Long                      â”‚    â”‚ specifications: Map          â”‚
â”‚ productName: String           â”‚    â”‚ image_data: Map              â”‚
â”‚ price: BigDecimal            â”‚    â”‚ category: String             â”‚
â”‚ stockQuantity: Integer       â”‚    â”‚ attributes: Map              â”‚
â”‚ isAvailable: Boolean         â”‚    â”‚ metadata: Map                â”‚
â”‚ creator: User                â”‚    â”‚                              â”‚
â”‚ createdAt: LocalDateTime     â”‚    â”‚                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ’» å®æˆ˜ï¼šå•†å“å®ä½“è®¾è®¡

### 1ï¸âƒ£ åŸºç¡€ç»“æ„è®¾è®¡

è®©æˆ‘ä»¬ä»å•†å“çš„åŸºç¡€ä¿¡æ¯å¼€å§‹ï¼š

```java
package com.cmliy.springweb.model;

import jakarta.persistence.*;
import lombok.Data;
import lombok.EqualsAndHashCode;
import org.hibernate.annotations.*;

import java.math.BigDecimal;
import java.time.LocalDateTime;
import java.util.Map;
import java.util.HashMap;

/**
 * ğŸ“¦ å•†å“å®ä½“
 *
 * æ ¸å¿ƒå•†å“ä¿¡æ¯å­˜å‚¨ï¼Œé‡‡ç”¨æ··åˆå­˜å‚¨ç­–ç•¥ï¼š
 * - åŸºç¡€ä¿¡æ¯ï¼šå…³ç³»å‹å­—æ®µï¼ˆå›ºå®šç»“æ„ï¼Œé¢‘ç¹æŸ¥è¯¢ï¼‰
 * - æ‰©å±•ä¿¡æ¯ï¼šJSONBå­—æ®µï¼ˆåŠ¨æ€ç»“æ„ï¼Œçµæ´»æ‰©å±•ï¼‰
 */
@Slf4j
@Data
@EqualsAndHashCode(callSuper = false)
@Entity
@Table(name = "products")
public class Product {

    /**
     * ğŸ†” å•†å“å”¯ä¸€æ ‡è¯†ç¬¦
     *
     * ä¸»é”®è‡ªå¢ï¼Œç¡®ä¿æ¯ä¸ªå•†å“éƒ½æœ‰å”¯ä¸€æ ‡è¯†
     * ä½¿ç”¨Longç±»å‹ï¼Œæ”¯æŒå¤§æ•°æ®é‡
     */
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    /**
     * ğŸ“ å•†å“åç§°
     *
     * å•†å“çš„æ˜¾ç¤ºåç§°ï¼Œå¿…é¡»å”¯ä¸€ä¸”ä¸ä¸ºç©º
     * é•¿åº¦é™åˆ¶50å­—ç¬¦ï¼Œé€‚åˆå¤§å¤šæ•°å•†å“åç§°
     * æ·»åŠ å”¯ä¸€ç´¢å¼•ï¼Œé˜²æ­¢é‡å¤å•†å“
     */
    @Column(name = "product_name", unique = true, nullable = false, length = 50)
    private String productName;

    /**
     * ğŸ“„ å•†å“è¯¦ç»†æè¿°
     *
     * å•†å“çš„è¯¦ç»†è¯´æ˜ï¼Œæ”¯æŒå¯Œæ–‡æœ¬
     * ä½¿ç”¨TEXTç±»å‹ï¼Œå¯å­˜å‚¨å¤§æ®µå†…å®¹
     */
    @Column(name = "description", columnDefinition = "TEXT")
    private String description;

    /**
     * ğŸ’° å•†å“ä»·æ ¼
     *
     * å•†å“çš„é”€å”®ä»·æ ¼ï¼Œå¿…é¡»ä¸ä¸ºç©º
     * ä½¿ç”¨BigDecimalä¿è¯ç²¾åº¦ï¼Œé¿å…æµ®ç‚¹æ•°è¯¯å·®
     * precision=10, scale=2ï¼šæœ€å¤§99999999.99
     */
    @Column(name = "price", nullable = false, precision = 10, scale = 2)
    private BigDecimal price;

    /**
     * ğŸ“Š é”€å”®æ•°é‡
     *
     * å•†å“çš„æ€»é”€å”®æ•°é‡ï¼Œé»˜è®¤ä¸º0
     * ç”¨äºç»Ÿè®¡åˆ†æå’Œçƒ­é—¨å•†å“æ’åº
     */
    @Column(name = "sales_count", nullable = false)
    private Integer salesCount = 0;

    /**
     * ğŸ·ï¸ æŠ˜æ‰£ç™¾åˆ†æ¯”
     *
     * å•†å“çš„æŠ˜æ‰£ç™¾åˆ†æ¯”ï¼Œé»˜è®¤ä¸º0ï¼ˆæ— æŠ˜æ‰£ï¼‰
     * precision=5, scale=2ï¼šæœ€å¤§999.99%
     */
    @Column(name = "discount", precision = 5, scale = 2)
    private BigDecimal discount = BigDecimal.ZERO;

    /**
     * ğŸ“¦ åº“å­˜æ•°é‡
     *
     * å•†å“çš„åº“å­˜æ•°é‡ï¼Œé»˜è®¤ä¸º0
     * ç”¨äºåº“å­˜ç®¡ç†å’Œè´­ä¹°å¯ç”¨æ€§æ£€æŸ¥
     */
    @Column(name = "stock_quantity", nullable = false)
    private Integer stockQuantity = 0;

    /**
     * âœ… å•†å“ä¸Šæ¶çŠ¶æ€
     *
     * trueï¼šä¸Šæ¶å¯è´­ä¹°ï¼Œfalseï¼šä¸‹æ¶ä¸å¯è´­ä¹°
     * é»˜è®¤falseï¼Œæ–°åˆ›å»ºå•†å“éœ€è¦æ‰‹åŠ¨ä¸Šæ¶
     */
    @Column(name = "is_available", nullable = false)
    private Boolean isAvailable = false;
}
```

### 2ï¸âƒ£ JSONBå­—æ®µè®¾è®¡

ç°åœ¨è®©æˆ‘ä»¬è®¾è®¡æœ€é‡è¦çš„JSONBå­—æ®µï¼š

```java
public class Product {
    // ... åŸºç¡€å­—æ®µ ...

    /**
     * ğŸ—„ï¸ å•†å“æ‰©å±•æ•°æ® - JSONBå­—æ®µ
     *
     * è¿™æ˜¯å•†å“å®ä½“çš„æ ¸å¿ƒåˆ›æ–°ç‚¹ï¼ä½¿ç”¨PostgreSQLåŸç”ŸJSONBç±»å‹ï¼š
     *
     * å­˜å‚¨å†…å®¹ï¼š
     * - specifications: å•†å“è§„æ ¼ï¼ˆé¢œè‰²ã€å°ºç ã€æè´¨ç­‰ï¼‰
     * - image_data: å›¾ç‰‡ä¿¡æ¯ï¼ˆä¸»å›¾ã€ç¼©ç•¥å›¾ã€æ€»æ•°ç­‰ï¼‰
     * - category: å•†å“åˆ†ç±»
     * - attributes: å…¶ä»–å±æ€§ï¼ˆé‡é‡ã€äº§åœ°ã€ä¿ä¿®æœŸç­‰ï¼‰
     * - metadata: å…ƒæ•°æ®ï¼ˆSEOä¿¡æ¯ã€æ ‡ç­¾ç­‰ï¼‰
     *
     * æŠ€æœ¯ä¼˜åŠ¿ï¼š
     * - âœ… åŠ¨æ€ç»“æ„ï¼šæ— éœ€ä¿®æ”¹è¡¨ç»“æ„å³å¯æ·»åŠ æ–°å±æ€§
     * - âœ… çµæ´»æŸ¥è¯¢ï¼šæ”¯æŒJSONBåŸç”ŸæŸ¥è¯¢è¯­æ³•
     * - âœ… ç±»å‹å®‰å…¨ï¼šHibernateè‡ªåŠ¨ç±»å‹è½¬æ¢
     * - âœ… æ€§èƒ½ä¼˜ç§€ï¼šPostgreSQL JSONBç´¢å¼•æ”¯æŒ
     */
    @JdbcTypeCode(SqlTypes.JSON)  // ğŸ”§ å…³é”®ï¼šæŒ‡å®šJSONç±»å‹å¤„ç†
    @Column(name = "product_data", columnDefinition = "jsonb")
    private Map<String, Object> productData = new HashMap<>();

    /**
     * â° åˆ›å»ºæ—¶é—´æˆ³
     *
     * è®°å½•å•†å“åˆ›å»ºæ—¶é—´ï¼Œç”±æ•°æ®åº“è‡ªåŠ¨ç®¡ç†
     * @CreationTimestamp è‡ªåŠ¨è®¾ç½®åˆ›å»ºæ—¶é—´
     */
    @CreationTimestamp
    @Column(name = "created_at", updatable = false, nullable = false)
    private LocalDateTime createdAt;

    /**
     * ğŸ”„ æ›´æ–°æ—¶é—´æˆ³
     *
     * è®°å½•å•†å“æœ€åæ›´æ–°æ—¶é—´ï¼Œç”±æ•°æ®åº“è‡ªåŠ¨ç®¡ç†
     * @UpdateTimestamp è‡ªåŠ¨æ›´æ–°ä¿®æ”¹æ—¶é—´
     */
    @UpdateTimestamp
    @Column(name = "updated_at", nullable = false)
    private LocalDateTime updatedAt;

    /**
     * ğŸ‘¤ å•†å“åˆ›å»ºè€…
     *
     * åˆ›å»ºè¯¥å•†å“çš„ç”¨æˆ·ï¼Œå¿…é¡»æŒ‡å®š
     * ä½¿ç”¨LAZYåŠ è½½é¿å…N+1æŸ¥è¯¢é—®é¢˜
     */
    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "creator_id", nullable = false)
    private User creator;
}
```

### 3ï¸âƒ£ ä¸šåŠ¡é€»è¾‘æ–¹æ³•è®¾è®¡

ä¸ºå®ä½“æ·»åŠ å®ç”¨çš„ä¸šåŠ¡é€»è¾‘æ–¹æ³•ï¼š

```java
public class Product {
    // ... å­—æ®µå®šä¹‰ ...

    /**
     * ğŸ“ˆ å¢åŠ åº“å­˜
     *
     * å®‰å…¨åœ°å¢åŠ å•†å“åº“å­˜æ•°é‡
     * å‚æ•°éªŒè¯ï¼šç¡®ä¿æ•°é‡æœ‰æ•ˆ
     */
    public void increaseStock(Integer quantity) {
        if (quantity != null && quantity > 0) {
            this.stockQuantity += quantity;
        }
    }

    /**
     * ğŸ“‰ å‡å°‘åº“å­˜å¹¶å¢åŠ é”€é‡
     *
     * åŸå­æ“ä½œï¼šå‡å°‘åº“å­˜åŒæ—¶å¢åŠ é”€é‡
     * è¿”å›ï¼šæ“ä½œæ˜¯å¦æˆåŠŸï¼ˆåº“å­˜ä¸è¶³æ—¶è¿”å›falseï¼‰
     */
    public boolean decreaseStock(Integer quantity) {
        if (quantity != null && quantity > 0 && this.stockQuantity >= quantity) {
            this.stockQuantity -= quantity;
            this.salesCount += quantity;  // åŒæ­¥å¢åŠ é”€é‡
            return true;
        }
        return false;
    }

    /**
     * ğŸ›’ æ£€æŸ¥å•†å“æ˜¯å¦å¯è´­ä¹°
     *
     * ç»¼åˆåˆ¤æ–­ï¼šä¸Šæ¶çŠ¶æ€ + åº“å­˜å……è¶³
     * ç”¨äºè´­ä¹°å‰çš„å¯ç”¨æ€§æ£€æŸ¥
     */
    public boolean isPurchasable() {
        return this.isAvailable && this.stockQuantity > 0;
    }

    /**
     * ğŸ’° è®¡ç®—æŠ˜æ‰£ä»·æ ¼
     *
     * æ ¹æ®æŠ˜æ‰£ç™¾åˆ†æ¯”è®¡ç®—å®é™…é”€å”®ä»·æ ¼
     * æ— æŠ˜æ‰£æ—¶è¿”å›åŸä»·
     */
    public BigDecimal getDiscountedPrice() {
        if (discount != null && discount.compareTo(BigDecimal.ZERO) > 0) {
            return price.multiply(BigDecimal.ONE.subtract(discount.divide(BigDecimal.valueOf(100))));
        }
        return price;
    }

    /**
     * ğŸ“Š è·å–æŠ˜æ‰£é‡‘é¢
     *
     * è®¡ç®—æŠ˜æ‰£èŠ‚çœçš„é‡‘é¢
     * ç”¨äºæ˜¾ç¤ºç”¨æˆ·èŠ‚çœå¤šå°‘é’±
     */
    public BigDecimal getDiscountAmount() {
        if (discount != null && discount.compareTo(BigDecimal.ZERO) > 0) {
            return price.multiply(discount.divide(BigDecimal.valueOf(100)));
        }
        return BigDecimal.ZERO;
    }
}
```

### 4ï¸âƒ£ JSONBæ•°æ®è®¿é—®æ–¹æ³•

ä¸ºJSONBå­—æ®µæä¾›ç±»å‹å®‰å…¨çš„è®¿é—®æ–¹æ³•ï¼š

```java
public class Product {
    // ... å­—æ®µå’Œæ–¹æ³• ...

    /**
     * ğŸ“¸ è·å–ä¸»å›¾ç‰‡URL
     *
     * ä»productDataä¸­å®‰å…¨æå–ä¸»å›¾ç‰‡URL
     * è¿”å›nullå¦‚æœä¸å­˜åœ¨
     */
    public String getMainImage() {
        @SuppressWarnings("unchecked")
        Map<String, Object> imageData = (Map<String, Object>)
            productData.getOrDefault("image_data", new HashMap<>());
        return (String) imageData.get("main_image");
    }

    /**
     * ğŸ“‹ è·å–è§„æ ¼å±æ€§
     *
     * å®‰å…¨è·å–å•†å“è§„æ ¼ä¿¡æ¯
     * æ”¯æŒåŠ¨æ€è§„æ ¼ï¼Œå¦‚ï¼šé¢œè‰²ã€å°ºç ã€æè´¨ç­‰
     */
    public Object getSpecification(String key) {
        @SuppressWarnings("unchecked")
        Map<String, Object> specifications = (Map<String, Object>)
            productData.getOrDefault("specifications", new HashMap<>());
        return specifications.get(key);
    }

    /**
     * ğŸ“‹ è·å–æ‰€æœ‰è§„æ ¼å±æ€§
     *
     * è¿”å›ä¸å¯å˜çš„è§„æ ¼æ˜ å°„å‰¯æœ¬
     * ç¡®ä¿æ•°æ®å®‰å…¨æ€§ï¼Œé˜²æ­¢å¤–éƒ¨ä¿®æ”¹
     */
    @SuppressWarnings("unchecked")
    public Map<String, Object> getAllSpecifications() {
        return Map.copyOf((Map<String, Object>)
            productData.getOrDefault("specifications", new HashMap<>()));
    }

    /**
     * ğŸ–¼ï¸ è·å–å›¾ç‰‡æ€»æ•°
     *
     * ä»å›¾ç‰‡æ•°æ®ä¸­ç»Ÿè®¡å›¾ç‰‡æ•°é‡
     * ç”¨äºå‰ç«¯æ˜¾ç¤ºå›¾ç‰‡æ•°é‡
     */
    @SuppressWarnings("unchecked")
    public Integer getTotalImages() {
        Map<String, Object> imageData = (Map<String, Object>)
            productData.getOrDefault("image_data", new HashMap<>());
        return (Integer) imageData.getOrDefault("total_images", 0);
    }
}
```

---

## ğŸ” æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–

### ğŸ¯ ç´¢å¼•ç­–ç•¥

```java
@Entity
@Table(name = "products", indexes = {
    @Index(name = "idx_product_name", columnList = "product_name"),
    @Index(name = "idx_creator_id", columnList = "creator_id"),
    @Index(name = "idx_price", columnList = "price"),
    @Index(name = "idx_sales_count", columnList = "sales_count"),
    @Index(name = "idx_discount", columnList = "discount"),
    @Index(name = "idx_is_available", columnList = "is_available"),
    @Index(name = "idx_created_at", columnList = "created_at")
})
public class Product {
    // ... å®ä½“å†…å®¹ ...
}
```

**ç´¢å¼•è®¾è®¡åŸåˆ™**ï¼š

1. **é«˜é¢‘æŸ¥è¯¢å­—æ®µ**ï¼šproduct_nameã€creator_idã€is_available
2. **æ’åºå­—æ®µ**ï¼špriceã€sales_countã€created_at
3. **èŒƒå›´æŸ¥è¯¢**ï¼šdiscountï¼ˆä¿ƒé”€å•†å“ç­›é€‰ï¼‰
4. **å¤åˆç´¢å¼•**ï¼šæ ¹æ®å®é™…æŸ¥è¯¢éœ€æ±‚æ·»åŠ 

---

## ğŸ’¡ è®¾è®¡å“²å­¦æ€»ç»“

### ğŸ¯ æ ¸å¿ƒè®¾è®¡åŸåˆ™

1. **æ··åˆå­˜å‚¨ç­–ç•¥**ï¼šåŸºç¡€ä¿¡æ¯å…³ç³»å‹ï¼Œæ‰©å±•ä¿¡æ¯JSONB
2. **ä¸šåŠ¡é€»è¾‘å†…èš**ï¼šå®ä½“åŒ…å«æ ¸å¿ƒä¸šåŠ¡æ–¹æ³•
3. **ç±»å‹å®‰å…¨è®¿é—®**ï¼šJSONBæ•°æ®é€šè¿‡ç±»å‹å®‰å…¨æ–¹æ³•è®¿é—®
4. **ç´¢å¼•ä¼˜åŒ–**ï¼šæ ¹æ®æŸ¥è¯¢æ¨¡å¼è®¾è®¡ç´¢å¼•
5. **æ‰©å±•æ€§è€ƒè™‘**ï¼šä¸ºæœªæ¥åŠŸèƒ½é¢„ç•™ç©ºé—´

### ğŸ† æ¶æ„ä¼˜åŠ¿

| ä¼˜åŠ¿ | è¯´æ˜ | å½±å“ |
|------|------|------|
| **çµæ´»æ€§** | JSONBæ”¯æŒåŠ¨æ€å±æ€§ | æ— éœ€ä¿®æ”¹è¡¨ç»“æ„ |
| **æ€§èƒ½** | ç´¢å¼•ä¼˜åŒ– + æŸ¥è¯¢ä¼˜åŒ– | æ¯«ç§’çº§å“åº” |
| **å¯ç»´æŠ¤æ€§** | æ¸…æ™°çš„ä»£ç ç»“æ„ | é™ä½ç»´æŠ¤æˆæœ¬ |
| **æ‰©å±•æ€§** | é¢„ç•™JSONBæ‰©å±•ç©ºé—´ | æ”¯æŒæœªæ¥åŠŸèƒ½ |
| **ç±»å‹å®‰å…¨** | å°è£…è®¿é—®æ–¹æ³• | ç¼–è¯‘æ—¶é”™è¯¯æ£€æŸ¥ |

---

## ğŸš€ å®è·µç»ƒä¹ 

### ğŸ’ª ç»ƒä¹ 1ï¼šæ‰©å±•å•†å“å®ä½“

ä¸ºProductå®ä½“æ·»åŠ ä»¥ä¸‹åŠŸèƒ½ï¼š

```java
/**
 * ç»ƒä¹ 1ï¼šæ·»åŠ å•†å“æ ‡ç­¾ç®¡ç†
 *
 * è¦æ±‚ï¼š
 * 1. åœ¨productDataä¸­æ·»åŠ tagså­—æ®µï¼ˆList<String>ï¼‰
 * 2. æä¾›addTag(String tag)æ–¹æ³•
 * 3. æä¾›removeTag(String tag)æ–¹æ³•
 * 4. æä¾›getAllTags()æ–¹æ³•è¿”å›æ‰€æœ‰æ ‡ç­¾
 * 5. æä¾›hasTag(String tag)åˆ¤æ–­æ˜¯å¦å­˜åœ¨æ ‡ç­¾
 */
public class Product {

    // æ·»åŠ ä½ çš„å®ç°ä»£ç ...
}
```

### ğŸ’ª ç»ƒä¹ 2ï¼šå•†å“è¯„åˆ†ç³»ç»Ÿ

```java
/**
 * ç»ƒä¹ 2ï¼šå®ç°å•†å“è¯„åˆ†ç»Ÿè®¡
 *
 * è¦æ±‚ï¼š
 * 1. åœ¨productDataä¸­æ·»åŠ rating_dataå­—æ®µ
 * 2. åŒ…å«ï¼šaverageRating, totalRatings, ratingDistribution
 * 3. æä¾›updateRating(double newRating)æ–¹æ³•æ›´æ–°è¯„åˆ†
 * 4. æä¾›getAverageRating()è·å–å¹³å‡è¯„åˆ†
 * 5. æä¾›getRatingDistribution()è·å–è¯„åˆ†åˆ†å¸ƒ
 */
public class Product {

    // æ·»åŠ ä½ çš„å®ç°ä»£ç ...
}
```

### ğŸ’ª ç»ƒä¹ 3ï¼šå•†å“SEOä¼˜åŒ–

```java
/**
 * ç»ƒä¹ 3ï¼šæ·»åŠ SEOç›¸å…³ä¿¡æ¯
 *
 * è¦æ±‚ï¼š
 * 1. åœ¨productDataä¸­æ·»åŠ seo_dataå­—æ®µ
 * 2. åŒ…å«ï¼šmetaTitle, metaDescription, keywords, slug
 * 3. æä¾›generateSlug()æ–¹æ³•æ ¹æ®å•†å“åç”ŸæˆURLå‹å¥½çš„slug
 * 4. æä¾›getSeoTitle()è¿”å›SEOæ ‡é¢˜ï¼ˆä¼˜å…ˆmetaTitleï¼Œ fallbackåˆ°productNameï¼‰
 * 5. æä¾›updateSeoData()æ–¹æ³•æ‰¹é‡æ›´æ–°SEOä¿¡æ¯
 */
public class Product {

    // æ·»åŠ ä½ çš„å®ç°ä»£ç ...
}
```

---

## âœ… æœ¬ç« æ£€æŸ¥æ¸…å•

- [ ] ç†è§£äº†PostgreSQL JSONBçš„ä¼˜åŠ¿å’Œåº”ç”¨åœºæ™¯
- [ ] æŒæ¡äº†æ··åˆå­˜å‚¨ç­–ç•¥çš„è®¾è®¡æ€æƒ³
- [ ] å­¦ä¼šäº†å•†å“å®ä½“çš„å®Œæ•´è®¾è®¡æ–¹æ³•
- [ ] ç†è§£äº†JSONBå­—æ®µçš„ç±»å‹å®‰å…¨è®¿é—®æ–¹å¼
- [ ] æŒæ¡äº†æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–çš„åŸºæœ¬åŸåˆ™
- [ ] å®Œæˆäº†æ‰€æœ‰å®è·µç»ƒä¹ 
- [ ] èƒ½å¤Ÿè§£é‡Šä¸ºä»€ä¹ˆé€‰æ‹©JSONBè€Œä¸æ˜¯ä¼ ç»Ÿå…³ç³»å‹è®¾è®¡

---

## ğŸ¯ æœ¬ç« å°ç»“

æœ¬ç« æˆ‘ä»¬æ·±å…¥æ¢è®¨äº†ä¼ä¸šçº§å•†å“å®ä½“çš„è®¾è®¡å“²å­¦ï¼Œé‡ç‚¹å­¦ä¹ äº†ï¼š

1. **PostgreSQL JSONBçš„åº”ç”¨**ï¼šç†è§£äº†JSONBç›¸æ¯”ä¼ ç»Ÿå…³ç³»å‹å­˜å‚¨çš„ä¼˜åŠ¿
2. **æ··åˆå­˜å‚¨ç­–ç•¥**ï¼šæŒæ¡äº†åŸºç¡€ä¿¡æ¯å…³ç³»å‹ã€æ‰©å±•ä¿¡æ¯JSONBçš„è®¾è®¡æ¨¡å¼
3. **å®ä½“è®¾è®¡æœ€ä½³å®è·µ**ï¼šå­¦ä¼šäº†å¦‚ä½•è®¾è®¡å¯æ‰©å±•ã€å¯ç»´æŠ¤çš„å•†å“å®ä½“
4. **ä¸šåŠ¡é€»è¾‘å°è£…**ï¼šç†è§£äº†å°†ä¸šåŠ¡é€»è¾‘å†…èšåˆ°å®ä½“ä¸­çš„é‡è¦æ€§
5. **ç±»å‹å®‰å…¨è®¿é—®**ï¼šæŒæ¡äº†JSONBæ•°æ®çš„ç±»å‹å®‰å…¨è®¿é—®æ–¹æ³•

å•†å“å®ä½“è®¾è®¡æ˜¯æ•´ä¸ªå•†å“ç®¡ç†ç³»ç»Ÿçš„åŸºç¡€ï¼Œè‰¯å¥½çš„è®¾è®¡ä¸ºåç»­çš„åŠŸèƒ½å¼€å‘å¥ å®šäº†åšå®çš„åŸºç¡€ã€‚åœ¨ä¸‹ä¸€ç« ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•åŸºäºè¿™ä¸ªå®ä½“è®¾è®¡å®ç°å¤æ‚çš„RepositoryæŸ¥è¯¢åŠŸèƒ½ã€‚

---

**ä¸‹ä¸€ç« **ï¼š[ğŸ” ç¬¬2ç« ï¼šå•†å“Repositoryå¼€å‘](02-å•†å“Repositoryå¼€å‘.md)